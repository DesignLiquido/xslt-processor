/** @type {any} */
var XsltProcessor=(()=>{var we=Object.defineProperty,It=Object.defineProperties,Ft=Object.getOwnPropertyDescriptor,kt=Object.getOwnPropertyDescriptors,Ut=Object.getOwnPropertyNames,ht=Object.getOwnPropertySymbols;var pt=Object.prototype.hasOwnProperty,$t=Object.prototype.propertyIsEnumerable;var dt=(i,e,t)=>e in i?we(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,se=(i,e)=>{for(var t in e||(e={}))pt.call(e,t)&&dt(i,t,e[t]);if(ht)for(var t of ht(e))$t.call(e,t)&&dt(i,t,e[t]);return i},me=(i,e)=>It(i,kt(e));var M=(i,e)=>()=>(i&&(e=i(i=0)),e);var Je=(i,e)=>{for(var t in e)we(i,t,{get:e[t],enumerable:!0})},Bt=(i,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Ut(e))!pt.call(i,n)&&n!==t&&we(i,n,{get:()=>e[n],enumerable:!(r=Ft(e,n))||r.enumerable});return i};var Ye=i=>Bt(we({},"__esModule",{value:!0}),i);var X=(i,e,t)=>new Promise((r,n)=>{var s=l=>{try{a(t.next(l))}catch(u){n(u)}},o=l=>{try{a(t.throw(l))}catch(u){n(u)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,o);a((t=t.apply(i,e)).next())});function Q(i,e){return i.getAttributeValue(e)}function $(i,e,t){return i.setAttribute(e,t)}function P(i,e){return i.appendChild(e)}function V(i,e){return i.createTextNode(e)}function z(i,e){return i.createElement(e)}function Ne(i,e){return i.createCDATASection(e)}function Z(i,e){return i.createComment(e)}function ie(i){return i.createDocumentFragment()}function De(i,e){return i.createDTDSection(e)}var _e=M(()=>{});var ft={};Je(ft,{DOM_ATTRIBUTE_NODE:()=>g,DOM_CDATA_SECTION_NODE:()=>A,DOM_COMMENT_NODE:()=>I,DOM_DOCUMENT_FRAGMENT_NODE:()=>w,DOM_DOCUMENT_NODE:()=>S,DOM_DOCUMENT_TYPE_NODE:()=>ge,DOM_ELEMENT_NODE:()=>x,DOM_ENTITY_NODE:()=>jt,DOM_ENTITY_REFERENCE_NODE:()=>Gt,DOM_NOTATION_NODE:()=>zt,DOM_PROCESSING_INSTRUCTION_NODE:()=>qe,DOM_TEXT_NODE:()=>C});var x,g,C,A,Gt,jt,qe,I,S,ge,w,zt,D=M(()=>{x=1,g=2,C=3,A=4,Gt=5,jt=6,qe=7,I=8,S=9,ge=10,w=11,zt=12});var W,O,Le=M(()=>{D();W=class W{constructor(e,t,r,n,s){this.id=Math.random()*(Number.MAX_SAFE_INTEGER-1)+1,this.childNodes=[],this.visited=!1,this.escape=!0,this.fromXslText=!1,this.siblingPosition=-1,this.init(e,t,r,n,s)}init(e,t,r,n,s){this.nodeType=e-0,this.nodeName=`${t}`,this.nodeValue=`${r}`,this.ownerDocument=n,this.namespaceUri=s||null,[this.prefix,this.localName]=this.qualifiedNameToParts(`${t}`),this.firstChild=null,this.lastChild=null,this.nextSibling=null,this.previousSibling=null,this.parentNode=null}qualifiedNameToParts(e){return e.includes(":")?e.split(":"):[null,e]}domTraverseElements(e,t,r){let n;if(t&&(n=t.call(null,e),typeof n=="boolean"&&!n))return!1;for(let s=e.firstChild;s;s=s.nextSibling)if(s.nodeType==1&&(n=this.domTraverseElements.call(this,s,t,r),typeof n=="boolean"&&!n))return!1;if(r&&(n=r.call(null,e),typeof n=="boolean"&&!n))return!1}static recycle(e){if(e){if(e.constructor.name==="XDocument"){this.recycle(e.documentElement);return}if(e.constructor==this){this._unusedXNodes.push(e);for(let t=0;t<e.childNodes.length;++t)this.recycle(e.childNodes[t]);e.childNodes.length=0,e.init.call(0,"","",null)}}}static create(e,t,r,n,s){if(this._unusedXNodes.length>0){let o=this._unusedXNodes.pop();return o.init(e,t,r,n,s),o}return new W(e,t,r,n,s)}static clone(e,t){let r=new W(e.nodeType,e.nodeName,e.nodeValue,t,e.namespaceUri);r.id=e.id;for(let n of e.childNodes)r.appendChild(W.clone(n,r));return r}appendChild(e){this.childNodes.length===0&&(this.firstChild=e),e.previousSibling=this.lastChild,e.nextSibling=null,this.lastChild&&(this.lastChild.nextSibling=e),e.parentNode=this,this.lastChild=e,this.childNodes.push(e)}replaceChild(e,t){if(t!=e){for(let r=0;r<this.childNodes.length;++r)if(this.childNodes[r]==t){this.childNodes[r]=e;let n=t.parentNode;t.parentNode=null,e.parentNode=n,n=t.previousSibling,t.previousSibling=null,e.previousSibling=n,e.previousSibling&&(e.previousSibling.nextSibling=e),n=t.nextSibling,t.nextSibling=null,e.nextSibling=n,e.nextSibling&&(e.nextSibling.previousSibling=e),this.firstChild==t&&(this.firstChild=e),this.lastChild==t&&(this.lastChild=e);break}}}insertBefore(e,t){if(t==e||t.parentNode!=this)return;e.parentNode&&e.parentNode.removeChild(e);let r=[];for(let n of this.childNodes)n==t&&(r.push(e),e.parentNode=this,e.previousSibling=t.previousSibling,t.previousSibling=e,e.previousSibling&&(e.previousSibling.nextSibling=e),e.nextSibling=t,this.firstChild==t&&(this.firstChild=e)),r.push(n);this.childNodes=r}removeChild(e){let t=[];for(let r of this.childNodes)r!=e?t.push(r):(r.previousSibling&&(r.previousSibling.nextSibling=r.nextSibling),r.nextSibling&&(r.nextSibling.previousSibling=r.previousSibling),this.firstChild==r&&(this.firstChild=r.nextSibling),this.lastChild==r&&(this.lastChild=r.previousSibling));this.childNodes=t}hasAttributes(){return this.childNodes.filter(t=>t.nodeType===2).length>0}setAttribute(e,t){let r=this.childNodes.filter(s=>s.nodeType===2);for(let s=0;s<r.length;++s)if(r[s].nodeName==e){r[s].nodeValue=`${t}`;return}let n=W.create(2,e,t,this);n.parentNode=this,this.appendChild(n)}setAttributeNS(e,t,r){let n=this.childNodes.filter(o=>o.nodeType===2);for(let o=0;o<n.length;++o){let a=n[o];if(a.namespaceUri==e&&a.localName==this.qualifiedNameToParts(`${t}`)[1]){a.nodeValue=`${r}`,a.nodeName=`${t}`,a.prefix=this.qualifiedNameToParts(`${t}`)[0];return}}let s=W.create(2,t,r,this,e);s.parentNode=this,this.appendChild(s)}getAttributeValue(e){let t=this.childNodes.filter(r=>r.nodeType===2);for(let r=0;r<t.length;++r)if(t[r].nodeName===e)return t[r].nodeValue;return null}getAttributeNS(e,t){let r=this.childNodes.filter(n=>n.nodeType===2);for(let n=0;n<r.length;++n){let s=r[n];if(s.namespaceUri===e&&s.localName===t)return s.nodeValue}return null}hasAttribute(e){let t=this.childNodes.filter(r=>r.nodeType===2);for(let r=0;r<t.length;++r)if(t[r].nodeName===e)return!0;return!1}hasAttributeNS(e,t){let r=this.childNodes.filter(n=>n.nodeType===2);for(let n=0;n<r.length;++n){let s=r[n];if(s.namespaceUri===e&&s.localName===t)return!0}return!1}removeAttribute(e){let t=[];for(let r=0;r<this.childNodes.length;++r){let n=this.childNodes[r];if(n.nodeType!==2){t.push(n);continue}n.nodeName!==e&&t.push(n)}this.childNodes=t}removeAttributeNS(e,t){let r=[];for(let n=0;n<this.childNodes.length;++n){let s=this.childNodes[n];if(s.nodeType!==2){r.push(s);continue}(s.localName!==t||s.namespaceUri!==e)&&r.push(s)}this.childNodes=r}getElementsByTagName(e){let t=[],r=this;return e=="*"?this.domTraverseElements(this,n=>{r!=n&&t.push(n)},null):this.domTraverseElements(this,n=>{r!=n&&n.nodeName==e&&t.push(n)},null),t}getElementsByTagNameNS(e,t){let r=[],n=this;return e=="*"&&t=="*"?this.domTraverseElements(this,s=>{n!=s&&r.push(s)},null):e=="*"?this.domTraverseElements(this,s=>{n!=s&&s.localName==t&&r.push(s)},null):t=="*"?this.domTraverseElements(this,s=>{n!=s&&s.namespaceUri==e&&r.push(s)},null):this.domTraverseElements(this,s=>{n!=s&&s.localName==t&&s.namespaceUri==e&&r.push(s)},null),r}getElementById(e){let t=null;return this.domTraverseElements(this,r=>{if(r.getAttributeValue("id")==e)return t=r,!1},null),t}getAncestorByLocalName(e){if(!(this.parentNode===null||this.parentNode===void 0))return this.parentNode.localName===e?this.parentNode:this.parentNode.getAncestorByLocalName(e)}getAncestorById(e){if(!(this.parentNode===null||this.parentNode===void 0))return this.parentNode.id===e?this.parentNode:this.parentNode.getAncestorById(e)}toString(){return`${this.nodeType}, ${this.nodeName}, ${this.nodeValue}`}};W._unusedXNodes=[];O=W});var H,Ke=M(()=>{D();Le();H=class extends O{constructor(){super(9,"#document",null,null),this.documentElement=null}appendChild(e){super.appendChild(e),this.documentElement=this.childNodes[0]}createElement(e){return O.create(1,e,null,this)}createElementNS(e,t){return O.create(1,t,null,this,e)}createDocumentFragment(){return O.create(11,"#document-fragment",null,this)}createTextNode(e){return O.create(3,"#text",e,this)}createAttribute(e){return O.create(2,e,null,this)}createAttributeNS(e,t){return O.create(2,t,null,this,e)}createComment(e){return O.create(8,"#comment",e,this)}createCDATASection(e){return O.create(4,"#cdata-section",e,this)}createDTDSection(e){return O.create(10,"#dtd-section",e,this)}}});function oe(i){if(!i)return i;let e=i.replace(/&([a-zA-Z]+);/g,(t,r)=>{let n=r.toLowerCase();return Wt[n]||t});return e=e.replace(/&#(\d+);/g,(t,r)=>{try{let n=parseInt(r,10);return String.fromCharCode(n)}catch(n){return t}}),e=e.replace(/&#[xX]([0-9a-fA-F]+);/g,(t,r)=>{try{let n=parseInt(r,16);return String.fromCharCode(n)}catch(n){return t}}),e}var Wt,Qe=M(()=>{Wt={amp:"&",lt:"<",gt:">",quot:'"',apos:"'",nbsp:"\xA0",copy:"\xA9",reg:"\xAE",times:"\xD7",divide:"\xF7",euro:"\u20AC",pound:"\xA3",yen:"\xA5",cent:"\xA2",sect:"\xA7",para:"\xB6",hellip:"\u2026",middot:"\xB7",deg:"\xB0"}});function B(i,e=!1){if(!i)return"";let t="";switch(i.nodeType){case 10:return`<!DOCTYPE ${i.nodeValue}>`;case 3:case 4:case 2:return i.nodeValue;case 1:case 9:case 11:if(!e){let n=i,s=n.innerText;if(s!==void 0)return s;let o=n.textContent;if(o!==void 0)return o}let r=i.childNodes.filter(n=>n.nodeType!==2);for(let n=0;n<r.length;++n)t+=B(r[n]);return t}}function tt(i,e=!1){if(!i)return"";let t="";switch(i.nodeType){case 2:case 3:t+=i.nodeValue;break;case 4:t+=i.nodeValue;break;case 9:case 11:case 1:if(!e){let n=i,s=n.innerText;if(s!==void 0)return s;let o=n.textContent;if(o!==void 0)return o}let r=i.childNodes.length;for(let n=0;n<r;++n)t+=B(i.childNodes[n]);break}return t}function Ht(i,e={cData:!0,escape:!0,selfClosingTags:!0,outputMethod:"xml"}){let t=[];return Ze(i,t,e),t.join("")}function Ze(i,e,t){if(i.nodeType==3)e.push(ee(i.nodeValue));else if(i.nodeType==4)t.cData?e.push(i.nodeValue):e.push(`<![CDATA[${i.nodeValue}]]>`);else if(i.nodeType==8)e.push(`<!--${i.nodeValue}-->`);else if(i.nodeType==1){e.push(`<${J(i)}`);for(let r=0;r<i.childNodes.length;++r){let n=i.childNodes[r];!n||n.nodeType!==2||n.nodeName&&n.nodeValue&&e.push(` ${J(n)}="${Nt(n.nodeValue)}"`)}if(i.childNodes.length===0)t.selfClosingTags||t.outputMethod==="html"&&["hr","link"].includes(i.nodeName)?e.push("/>"):e.push(`></${J(i)}>`);else{e.push(">");for(let r=0;r<i.childNodes.length;++r)Ze(i.childNodes[r],e,t);e.push(`</${J(i)}>`)}}else if(i.nodeType==9||i.nodeType==11)for(let r=0;r<i.childNodes.length;++r)Ze(i.childNodes[r],e,t)}function rt(i,e={cData:!0,escape:!0,selfClosingTags:!0,outputMethod:"xml"}){let t=[];return xe(i,t,e),t.join("")}function xe(i,e,t){if(i.visited)return;let r=i.nodeType,n=i.nodeValue;if(r===3){let s=i.fromXslText===!0;if(i.nodeValue&&(s||i.nodeValue.trim()!=="")){let o=i.escape&&t.escape?ee(i.nodeValue):mt(i.nodeValue);e.push(o)}}else if(r===4)t.outputMethod==="text"?e.push(n):t.cData?e.push(ee(n)):e.push(`<![CDATA[${n}]]>`);else if(r==8)t.outputMethod!=="text"&&e.push(`<!-- ${n} -->`);else if(r==1)t.outputMethod==="text"?qt(i,e,t):i.nodeName!==null&&i.nodeName!==void 0?Jt(i,e,t):Yt(i,e,t);else if(r===9||r===11){let s=i.firstChild?[]:i.childNodes;if(i.firstChild){let o=i.firstChild;for(;o;)s.push(o),o=o.nextSibling}s.sort((o,a)=>o.siblingPosition-a.siblingPosition);for(let o=0;o<s.length;++o)xe(s[o],e,t)}i.visited=!0}function Jt(i,e,t){e.push(`<${J(i)}`);let r=[];if(i.firstChild){let s=i.firstChild;for(;s;)s.nodeType===2&&r.push(s),s=s.nextSibling}r.length===0&&(r=i.childNodes.filter(s=>s.nodeType===2));for(let s=0;s<r.length;++s){let o=r[s];o&&o.nodeName&&o.nodeValue&&e.push(` ${J(o)}="${Nt(o.nodeValue)}"`)}let n=[];if(i.firstChild){let s=i.firstChild;for(;s;)s.nodeType!==2&&n.push(s),s=s.nextSibling}if(n.length===0&&(n=i.childNodes.filter(s=>s.nodeType!==2)),n=n.sort((s,o)=>s.siblingPosition-o.siblingPosition),n.length===0)t.outputMethod==="html"&&["hr","link","meta"].includes(i.nodeName)?e.push(">"):t.selfClosingTags?e.push("/>"):e.push(`></${J(i)}>`);else{e.push(">");for(let s=0;s<n.length;++s)xe(n[s],e,t);e.push(`</${J(i)}>`)}}function Yt(i,e,t){let r=[];if(i.firstChild){let n=i.firstChild;for(;n;)r.push(n),n=n.nextSibling}else r=i.childNodes;r=r.sort((n,s)=>n.siblingPosition-s.siblingPosition);for(let n=0;n<r.length;++n)xe(r[n],e,t)}function qt(i,e,t){let r=[];if(i.firstChild){let n=i.firstChild;for(;n;)r.push(n),n=n.nextSibling}else r=i.childNodes;r=r.sort((n,s)=>n.siblingPosition-s.siblingPosition);for(let n=0;n<r.length;++n)xe(r[n],e,t)}function J(i){let e=i.nodeName;return i.prefix&&e.indexOf(`${i.prefix}:`)!=0?`${i.prefix}:${e}`:e}function mt(i){return`${i}`.replace(/&lt;/g,"<").replace(/&gt;/g,">")}function ee(i){return`${i}`.replace(/&/g,"&amp;").replace(/&amp;amp;/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Nt(i){return ee(i).replace(/"/g,"&quot;")}function f(i,e){let t=Q(i,e);return t&&oe(t)}function gt(i){if(i==null)throw new Error("Node has no valid owner document.");return i.nodeType===9?i:gt(i.ownerDocument)}function et(i){if(!i)return null;let e=i.nodeType;if(e===3||e===4){let t=i.nodeValue?i.nodeValue.trim():"";return t.length>0?t:null}if(e===8)return null;if(e===9||e===11){let t=i.childNodes||[],r=[];for(let n=0;n<t.length;n++){let s=t[n],o=et(s);o!==null&&r.push(o)}return r.length===0?null:r.length===1?r[0]:r}if(e===1){let t={},r=i,n=r.attributes&&r.attributes.length>0;if(n)for(let u=0;u<r.attributes.length;u++){let c=r.attributes[u];t["@"+c.nodeName]=c.nodeValue}let s=r.childNodes||[],o="",a=!1,l={};for(let u=0;u<s.length;u++){let c=s[u],d=c.nodeType;if(d===3||d===4){let h=c.nodeValue?c.nodeValue.trim():"";h.length>0&&(o+=h)}else if(d===1){a=!0;let h=c,m=h.localName||h.nodeName,p=et(c);p!==null&&(l[m]?(Array.isArray(l[m])||(l[m]=[l[m]]),l[m].push(p)):l[m]=p)}}if(Object.assign(t,l),!a&&o.length>0){if(!n&&Object.keys(l).length===0)return o;t["#text"]=o}return Object.keys(t).length===0?null:t}return null}function nt(i){if(!i)return"xml";let e=i.nodeType;if(e===9||e===11){let t=i.childNodes||[],r=0,n=0,s=!1;for(let o=0;o<t.length;o++){let a=t[o];a.nodeType===1?r++:a.nodeType===3&&(a.nodeValue?a.nodeValue.trim():"").length>0&&(n++,s=!0)}return r===0&&s?"text":"xml"}return(e===3||e===4)&&(i.nodeValue?i.nodeValue.trim():"").length>0?"text":"xml"}function st(i){if(!i)return"{}";let e=i;if(i.nodeType===9||i.nodeType===11){let o=i.childNodes||[];for(let a=0;a<o.length;a++)if(o[a].nodeType===1){e=o[a];break}}let t=e,r=t.localName||t.nodeName,n={},s=et(e);s===null?n[r]={}:(typeof s=="object"&&Array.isArray(s),n[r]=s);try{let o=JSON.parse(JSON.stringify(n));return JSON.stringify(o)}catch(o){return JSON.stringify(n)}}var xt=M(()=>{Qe();D();_e()});var yt=M(()=>{});var Re,Me,bt,Xt,Kt,Qt,Pt,Ct,vt,Ve,Zt,Ie,er,Et,tr,Ot,St,At,rr,Fe,nr,Tt,sr,wt,ir,Ar,Dt=M(()=>{Re=`[ 	\r
]+`,Me=`(${Re})?=(${Re})?`,bt="&#[0-9]+;|&#x[0-9a-fA-F]+;",Xt=`${Re}version${Me}("1\\.0"|'1\\.0')`,Kt="A-Za-z\xC0-\xD6\xD8-\xF6\xF8-\xFF\u0100-\u0131\u0134-\u013E\u0141-\u0148\u014A-\u017E\u0180-\u01C3\u01CD-\u01F0\u01F4-\u01F5\u01FA-\u0217\u0250-\u02A8\u02BB-\u02C1\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03CE\u03D0-\u03D6\u03DA\u03DC\u03DE\u03E0\u03E2-\u03F3\u0401-\u040C\u040E-\u044F\u0451-\u045C\u045E-\u0481\u0490-\u04C4\u04C7-\u04C8\u04CB-\u04CC\u04D0-\u04EB\u04EE-\u04F5\u04F8-\u04F9\u0531-\u0556\u0559\u0561-\u0586\u05D0-\u05EA\u05F0-\u05F2\u0621-\u063A\u0641-\u064A\u0671-\u06B7\u06BA-\u06BE\u06C0-\u06CE\u06D0-\u06D3\u06D5\u06E5-\u06E6\u0905-\u0939\u093D\u0958-\u0961\u0985-\u098C\u098F-\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09DC-\u09DD\u09DF-\u09E1\u09F0-\u09F1\u0A05-\u0A0A\u0A0F-\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32-\u0A33\u0A35-\u0A36\u0A38-\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8B\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2-\u0AB3\u0AB5-\u0AB9\u0ABD\u0AE0\u0B05-\u0B0C\u0B0F-\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32-\u0B33\u0B36-\u0B39\u0B3D\u0B5C-\u0B5D\u0B5F-\u0B61\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99-\u0B9A\u0B9C\u0B9E-\u0B9F\u0BA3-\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB5\u0BB7-\u0BB9\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C60-\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CDE\u0CE0-\u0CE1\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D28\u0D2A-\u0D39\u0D60-\u0D61\u0E01-\u0E2E\u0E30\u0E32-\u0E33\u0E40-\u0E45\u0E81-\u0E82\u0E84\u0E87-\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA-\u0EAB\u0EAD-\u0EAE\u0EB0\u0EB2-\u0EB3\u0EBD\u0EC0-\u0EC4\u0F40-\u0F47\u0F49-\u0F69\u10A0-\u10C5\u10D0-\u10F6\u1100\u1102-\u1103\u1105-\u1107\u1109\u110B-\u110C\u110E-\u1112\u113C\u113E\u1140\u114C\u114E\u1150\u1154-\u1155\u1159\u115F-\u1161\u1163\u1165\u1167\u1169\u116D-\u116E\u1172-\u1173\u1175\u119E\u11A8\u11AB\u11AE-\u11AF\u11B7-\u11B8\u11BA\u11BC-\u11C2\u11EB\u11F0\u11F9\u1E00-\u1E9B\u1EA0-\u1EF9\u1F00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2126\u212A-\u212B\u212E\u2180-\u2182\u3041-\u3094\u30A1-\u30FA\u3105-\u312C\uAC00-\uD7A3",Qt="\u4E00-\u9FA5\u3007\u3021-\u3029",Pt="\u0300-\u0345\u0360-\u0361\u0483-\u0486\u0591-\u05A1\u05A3-\u05B9\u05BB-\u05BD\u05BF\u05C1-\u05C2\u05C4\u064B-\u0652\u0670\u06D6-\u06DC\u06DD-\u06DF\u06E0-\u06E4\u06E7-\u06E8\u06EA-\u06ED\u0901-\u0903\u093C\u093E-\u094C\u094D\u0951-\u0954\u0962-\u0963\u0981-\u0983\u09BC\u09BE\u09BF\u09C0-\u09C4\u09C7-\u09C8\u09CB-\u09CD\u09D7\u09E2-\u09E3\u0A02\u0A3C\u0A3E\u0A3F\u0A40-\u0A42\u0A47-\u0A48\u0A4B-\u0A4D\u0A70-\u0A71\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0B01-\u0B03\u0B3C\u0B3E-\u0B43\u0B47-\u0B48\u0B4B-\u0B4D\u0B56-\u0B57\u0B82-\u0B83\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C01-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55-\u0C56\u0C82-\u0C83\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5-\u0CD6\u0D02-\u0D03\u0D3E-\u0D43\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB-\u0EBC\u0EC8-\u0ECD\u0F18-\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86-\u0F8B\u0F90-\u0F95\u0F97\u0F99-\u0FAD\u0FB1-\u0FB7\u0FB9\u20D0-\u20DC\u20E1\u302A-\u302F\u3099\u309A",Ct="0-9\u0660-\u0669\u06F0-\u06F9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE7-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29",vt="\xB7\u02D0\u02D1\u0387\u0640\u0E46\u0EC6\u3005\u3031-\u3035\u309D-\u309E\u30FC-\u30FE",Ve=Kt+Qt,Zt=`${Ve+Ct}\\._:${Pt}${vt}-`,Ie=`[${Ve}_:][${Zt}]*`,er=`&${Ie};`,Et=`${er}|${bt}`,tr=`"(([^<&"]|${Et})*)"|'(([^<&']|${Et})*)'`,Ot=`(${Ie})${Me}(${tr})`,St=`${Re}version${Me}("1\\.1"|'1\\.1')`,At=":A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD",rr=At+"\\.0-9\xB7\u0300-\u036F\u203F-\u2040-",Fe=`[${At}][${rr}]*`,nr=`&${Fe};`,Tt=`${nr}|${bt}`,sr=`"(([^<&"]|${Tt})*)"|'(([^<&']|${Tt})*)'`,wt=`(${Fe})${Me}(${sr})`,ir=`${Ve+Ct}\\._${Pt}${vt}-`,Ar=`[${Ve}_][${ir}]*`});var te,_t=M(()=>{Qe();_e();Ke();Dt();D();te=class{constructor(){this.regexEmpty=/\/$/;this.XML10_TAGNAME_REGEXP=new RegExp(`^(${Ie})`);this.XML10_ATTRIBUTE_REGEXP=new RegExp(Ot,"g");this.XML11_TAGNAME_REGEXP=new RegExp(`^(${Fe})`);this.XML11_ATTRIBUTE_REGEXP=new RegExp(wt,"g");this.lenientHtmlTags=["hr","link","meta"]}xmlParse(e){return e.toUpperCase().startsWith("<!DOCTYPE HTML")?this.htmlParse(e):this.xmlStrictParse(e)}namespaceMapAt(e){let t={xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace"},r=e;for(;r!==null;){for(let n=0;n<r.childNodes.length;n++){let s=r.childNodes[n];if(s.nodeType===2)if(s.nodeName.startsWith("xmlns:")){let o=s.nodeName.split(":")[1];o in t||(t[o]=s.nodeValue)}else s.nodeName=="xmlns"&&(""in t||(t[""]=s.nodeValue||null))}r=r.parentNode}return t}htmlParse(e){let t=new H,r=t,n=[],s=r;n.push(s);let o=!1,a=!1,l=!1,u=0;for(let c=0;c<e.length;++c){let d=e.charAt(c);if(o){if(!l&&d==="'")a=!a;else if(!a&&d==='"')l=!l;else if(!a&&!l&&d===">"){let h=e.slice(u,c);if(h.charAt(0)==="/")n.pop(),s=n[n.length-1];else if(h.charAt(0)!=="!"){let m=h.match(this.regexEmpty),p=this.XML10_TAGNAME_REGEXP.exec(h)[1],N=z(t,p),v;for(;v=this.XML10_ATTRIBUTE_REGEXP.exec(h);){let b=oe(v[5]||v[7]||"");$(N,v[1],b)}N.siblingPosition=s.childNodes.length,P(s,N),!m&&!this.lenientHtmlTags.includes(p)&&(s=N,n.push(N))}u=c+1,o=!1,a=!1,l=!1}}else if(d==="<"){let h=e.slice(u,c);if(h&&s!==r&&P(s,V(t,h)),e.slice(c+1,c+4)==="!--"){let m=e.slice(c+4).indexOf("-->");if(m){let p=Z(t,e.slice(c+4,c+m+4));P(s,p),c+=m+6}}else if(e.slice(c+1,c+9)==="!DOCTYPE"){let m=e.slice(c+9).indexOf(">");if(m){let p=e.slice(c+9,c+m+9).trimStart(),N=De(t,p);P(s,N),c+=m+p.length+5}}else o=!0;u=c+1}}return t}xmlStrictParse(e){let t,r;if(e.match(/^<\?xml/))if(e.search(new RegExp(Xt))===5)t=this.XML10_TAGNAME_REGEXP,r=this.XML10_ATTRIBUTE_REGEXP;else if(e.search(new RegExp(St))===5)t=this.XML11_TAGNAME_REGEXP,r=this.XML11_ATTRIBUTE_REGEXP;else throw new Error("XML VersionInfo has an unknown version number.");else t=this.XML10_TAGNAME_REGEXP,r=this.XML10_ATTRIBUTE_REGEXP;let n=new H,s=n,o=[],a=s;o.push(a);let l=!1,u=!1,c=!1,d=0;for(let h=0;h<e.length;++h){let m=e.charAt(h);if(l&&!c&&m==="'")u=!u;else if(l&&!u&&m==='"')c=!c;else if(l&&m===">"&&!u&&!c){let p=e.slice(d,h);if(p.charAt(0)==="/")o.pop(),a=o[o.length-1];else if(p.charAt(0)!=="?"){if(p.charAt(0)!=="!"){let N=p.match(this.regexEmpty),v=t.exec(p)[1],b=z(n,v),F;for(;F=r.exec(p);){let R=oe(F[5]||F[7]||"");$(b,F[1],R)}b.siblingPosition=a.childNodes.length,P(a,b),N||(a=b,o.push(b));let k=this.namespaceMapAt(b);b.prefix!==null?b.prefix in k&&(b.namespaceUri=k[b.prefix]):""in k&&(b.namespaceUri=k[""]);for(let R=0;R<b.childNodes.length;++R){let U=b.childNodes[R];U.nodeType===2&&U.prefix!==null&&U.prefix in k&&(U.namespaceUri=k[U.prefix])}}}d=h+1,l=!1,u=!1,c=!1}else if(!l&&m==="<"){let p=e.slice(d,h);if(p&&a!==s&&P(a,V(n,oe(p))),e.slice(h+1,h+4)==="!--"){let N=e.slice(h+4).indexOf("-->");if(N){let v=Z(n,e.slice(h+4,h+N+4));P(a,v),h+=N+6}}else if(e.slice(h+1,h+9)==="![CDATA["){let N=e.slice(h+9).indexOf("]]>");if(N){let v=Ne(n,e.slice(h+9,h+N+9));P(a,v),h+=N+11}}else if(e.slice(h+1,h+9)==="!DOCTYPE"){let N=e.slice(h+9).indexOf(">");if(N){let v=e.slice(h+9,h+N+9).trimStart(),b=De(n,v);P(a,b),h+=N+v.length+5}}else l=!0;d=h+1}}return s}}});var it,Lt=M(()=>{Le();it=class extends O{}});var Rt={};Je(Rt,{XBrowserNode:()=>it,XDocument:()=>H,XNode:()=>O,XmlParser:()=>te,detectAdaptiveOutputFormat:()=>nt,domAppendChild:()=>P,domCreateCDATASection:()=>Ne,domCreateComment:()=>Z,domCreateDTDSection:()=>De,domCreateDocumentFragment:()=>ie,domCreateElement:()=>z,domCreateTextNode:()=>V,domGetAttributeValue:()=>Q,domSetAttribute:()=>$,xmlEscapeText:()=>ee,xmlGetAttribute:()=>f,xmlOwnerDocument:()=>gt,xmlText:()=>Ht,xmlToJson:()=>st,xmlTransformedText:()=>rt,xmlUnescapeText:()=>mt,xmlValue:()=>B,xmlValueLegacyBehavior:()=>tt});var ae=M(()=>{_e();Ke();xt();yt();_t();Lt();Le()});var Nr={};Je(Nr,{ExprContext:()=>ne,XPath:()=>re,XmlParser:()=>te,Xslt:()=>He,xmlEscapeText:()=>ee});ae();var y=class{constructor(e,t){this.type=e,this.lexeme=t}};var or={ancestor:{type:"LOCATION",value:"ancestor"},"ancestor-or-self":{type:"LOCATION",value:"ancestor-or-self"},attribute:{type:"LOCATION",value:"attribute"},child:{type:"LOCATION",value:"child"},descendant:{type:"LOCATION",value:"descendant"},"descendant-or-self":{type:"LOCATION",value:"descendant-or-self"},following:{type:"LOCATION",value:"following"},"following-sibling":{type:"LOCATION",value:"following-sibling"},namespace:{type:"LOCATION",value:"namespace"},parent:{type:"LOCATION",value:"parent"},preceding:{type:"LOCATION",value:"preceding"},"preceding-sibling":{type:"LOCATION",value:"preceding-sibling"},self:{type:"LOCATION",value:"self"},node:{type:"NODE_TYPE",value:"node"},text:{type:"NODE_TYPE",value:"text"},comment:{type:"NODE_TYPE",value:"comment"},"processing-instruction":{type:"NODE_TYPE",value:"processing-instruction"},and:{type:"OPERATOR",value:"and"},or:{type:"OPERATOR",value:"or"},div:{type:"OPERATOR",value:"div"},mod:{type:"OPERATOR",value:"mod"},last:{type:"FUNCTION",value:"last"},position:{type:"FUNCTION",value:"position"},count:{type:"FUNCTION",value:"count"},id:{type:"FUNCTION",value:"id"},"local-name":{type:"FUNCTION",value:"local-name"},"namespace-uri":{type:"FUNCTION",value:"namespace-uri"},name:{type:"FUNCTION",value:"name"},string:{type:"FUNCTION",value:"string"},concat:{type:"FUNCTION",value:"concat"},"starts-with":{type:"FUNCTION",value:"starts-with"},contains:{type:"FUNCTION",value:"contains"},"substring-before":{type:"FUNCTION",value:"substring-before"},"substring-after":{type:"FUNCTION",value:"substring-after"},substring:{type:"FUNCTION",value:"substring"},"string-length":{type:"FUNCTION",value:"string-length"},"normalize-space":{type:"FUNCTION",value:"normalize-space"},translate:{type:"FUNCTION",value:"translate"},boolean:{type:"FUNCTION",value:"boolean"},not:{type:"FUNCTION",value:"not"},true:{type:"FUNCTION",value:"true"},false:{type:"FUNCTION",value:"false"},lang:{type:"FUNCTION",value:"lang"},number:{type:"FUNCTION",value:"number"},sum:{type:"FUNCTION",value:"sum"},floor:{type:"FUNCTION",value:"floor"},ceiling:{type:"FUNCTION",value:"ceiling"},round:{type:"FUNCTION",value:"round"},document:{type:"FUNCTION",value:"document"},key:{type:"FUNCTION",value:"key"},"format-number":{type:"FUNCTION",value:"format-number"},current:{type:"FUNCTION",value:"current"},"unparsed-entity-uri":{type:"FUNCTION",value:"unparsed-entity-uri"},"generate-id":{type:"FUNCTION",value:"generate-id"},"system-property":{type:"FUNCTION",value:"system-property"},"element-available":{type:"FUNCTION",value:"element-available"},"function-available":{type:"FUNCTION",value:"function-available"}},le=class{isAlpha(e){return/^[a-zA-Z_\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]$/.test(e)}isAlphaNumeric(e){return/^[a-zA-Z0-9_\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0300-\u036F\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]$/.test(e)}isNumber(e){return/^[0-9]$/.test(e)}isWhitespace(e){return/^[\s\t\n\r]$/.test(e)}peek(){return this.expression[this.current]}peekNext(){return this.expression[this.current+1]}next(){return this.expression[this.current++]}match(e){return this.current>=this.expression.length||this.expression[this.current]!==e?!1:(this.current++,!0)}parseIdentifier(e){let t=e;for(;this.current<this.expression.length;){let n=this.expression[this.current];if(this.isAlphaNumeric(n))t+=this.next();else if(n==="-"){let s=this.expression[this.current+1];if(s&&this.isAlphaNumeric(s))for(this.current++,t+="-";this.current<this.expression.length&&this.isAlphaNumeric(this.expression[this.current]);)t+=this.next();else break}else break}let r=or[t.toLowerCase()];if(r)return new y(r.type,t);if(t.length>0)return new y("IDENTIFIER",t);throw new Error(`Invalid identifier: ${t}`)}parseString(e){let t="";for(;this.current<this.expression.length&&this.expression[this.current]!==e;)t+=this.next();if(this.current>=this.expression.length)throw new Error("Unterminated string literal");return this.next(),new y("STRING",t)}parseNumber(e){let t=e;for(;this.current<this.expression.length&&this.isNumber(this.expression[this.current])&&this.expression[this.current]!==".";)t+=this.next();if(this.current<this.expression.length&&this.expression[this.current]===".")for(t+=this.next();this.current<this.expression.length&&this.isNumber(this.expression[this.current]);)t+=this.next();if(t.length>0)return new y("NUMBER",t);throw new Error(`Invalid number: ${t}`)}scanToken(){let e=this.next();if(this.isWhitespace(e))return null;switch(e){case"@":return new y("AT",e);case"$":return new y("DOLLAR",e);case"|":return new y("PIPE",e);case"{":return new y("OPEN_CURLY_BRACKET",e);case"}":return new y("CLOSE_CURLY_BRACKET",e);case"[":return new y("OPEN_SQUARE_BRACKET",e);case"]":return new y("CLOSE_SQUARE_BRACKET",e);case"(":return new y("OPEN_PAREN",e);case")":return new y("CLOSE_PAREN",e);case"+":return new y("PLUS",e);case"-":return new y("MINUS",e);case"*":return new y("ASTERISK",e);case",":return new y("COMMA",e);case".":return this.match(".")?new y("DOT_DOT",".."):this.peek()&&this.isNumber(this.peek())?this.parseNumber(e):new y("DOT",e);case"/":return this.match("/")?new y("DOUBLE_SLASH","//"):new y("SLASH",e);case":":return this.match(":")?new y("COLON_COLON","::"):new y("COLON",e);case"=":return new y("EQUALS",e);case"!":if(this.match("="))return new y("NOT_EQUALS","!=");throw new Error(`Unexpected character: ${e}`);case"<":return this.match("=")?new y("LESS_THAN_OR_EQUAL","<="):new y("LESS_THAN",e);case">":return this.match("=")?new y("GREATER_THAN_OR_EQUAL",">="):new y("GREATER_THAN",e);case"'":return this.parseString("'");case'"':return this.parseString('"');default:if(this.isNumber(e))return this.parseNumber(e);if(this.isAlpha(e))return this.parseIdentifier(e);throw new Error(`Unexpected character: ${e}`)}}scan(e){for(this.expression=e,this.tokens=[],this.current=0;this.current<this.expression.length;){let t=this.scanToken();t!==null&&this.tokens.push(t)}return this.tokens}};var T=class{};var ke=class extends T{constructor(e){super(),this.value=e}evaluate(e){return this.value}},Ue=class extends T{constructor(e){super(),this.value=e}evaluate(e){return this.value}};var $e=class extends T{constructor(e){super(),this.name=e}evaluate(e){if(!e.variables)throw new Error(`Variable $${this.name} is not defined`);if(!(this.name in e.variables))throw new Error(`Variable $${this.name} is not defined`);return e.variables[this.name]}};var Be=class extends T{constructor(e,t){super(),this.operator=e,this.operand=t}evaluate(e){let t=this.operand.evaluate(e);if(this.operator==="-")return-Number(t);throw new Error(`Unknown unary operator: ${this.operator}`)}};var ye=class extends T{constructor(e,t,r){super(),this.left=e,this.right=t,this.operator=r}evaluate(e){let t=this.left.evaluate(e),r=this.right.evaluate(e);return this.compare(t,r,this.operator)}compare(e,t,r){let n=Array.isArray(e),s=Array.isArray(t);return n&&s?this.compareNodeSets(e,t,r):n?this.compareNodeSetToValue(e,t,r):s?this.compareValueToNodeSet(e,t,r):this.comparePrimitives(e,t,r)}compareNodeSets(e,t,r){for(let n of e){let s=this.getStringValue(n);for(let o of t){let a=this.getStringValue(o);if(this.comparePrimitives(s,a,r))return!0}}return!1}compareNodeSetToValue(e,t,r){for(let n of e){let s=typeof t=="number"?Number(this.getStringValue(n)):this.getStringValue(n);if(this.comparePrimitives(s,t,r))return!0}return!1}compareValueToNodeSet(e,t,r){for(let n of t){let s=typeof e=="number"?Number(this.getStringValue(n)):this.getStringValue(n);if(this.comparePrimitives(e,s,r))return!0}return!1}comparePrimitives(e,t,r){switch(r){case"=":return e==t;case"!=":return e!=t;case"<":return Number(e)<Number(t);case">":return Number(e)>Number(t);case"<=":return Number(e)<=Number(t);case">=":return Number(e)>=Number(t);default:throw new Error(`Unknown operator: ${r}`)}}getStringValue(e){if(!e)return"";if(e.nodeType===3||e.nodeType===2)return e.nodeValue||e.textContent||"";if(e.textContent!==void 0)return e.textContent;if(e.childNodes){let t="";for(let r of Array.from(e.childNodes))r.nodeType===3?t+=r.nodeValue||"":r.nodeType===1&&(t+=this.getStringValue(r));return t}return String(e)}};var ue=class extends T{constructor(e,t,r){super(),this.left=e,this.right=t,this.operator=r}evaluate(e){let t=Number(this.left.evaluate(e)),r=Number(this.right.evaluate(e));switch(this.operator){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"div":return t/r;case"mod":return t%r;default:throw new Error(`Unknown arithmetic operator: ${this.operator}`)}}};var Ee=class extends T{constructor(e,t,r){super(),this.left=e,this.right=t,this.operator=r}toBoolean(e){return typeof e=="boolean"?e:typeof e=="number"?e!==0&&!isNaN(e):typeof e=="string"||Array.isArray(e)?e.length>0:!!e}evaluate(e){let t=this.toBoolean(this.left.evaluate(e));if(this.operator==="and")return t?this.toBoolean(this.right.evaluate(e)):!1;if(this.operator==="or")return t?!0:this.toBoolean(this.right.evaluate(e));throw new Error(`Unknown logical operator: ${this.operator}`)}};var G=class extends T{constructor(e,t,r=[]){super(),this.axis=e,this.nodeTest=t,this.predicates=r}evaluate(e){let t=e==null?void 0:e.node;if(!t)return[];let r=this.getNodesByAxis(t,e);return r=r.filter(n=>this.matchesNodeTest(n,e)),r=this.applyPredicates(r,e),r}getNodesByAxis(e,t){switch(this.axis){case"child":return this.getChildNodes(e);case"parent":return e.parentNode?[e.parentNode]:[];case"self":return[e];case"attribute":return e.attributes?Array.from(e.attributes):Array.from(e.childNodes||[]).filter(r=>r.nodeType===2);case"descendant":return this.getDescendants(e,!1);case"descendant-or-self":return this.getDescendants(e,!0);case"ancestor":return this.getAncestors(e,!1);case"ancestor-or-self":return this.getAncestors(e,!0);case"following-sibling":return this.getFollowingSiblings(e);case"preceding-sibling":return this.getPrecedingSiblings(e);case"following":return this.getFollowing(e);case"preceding":return this.getPreceding(e);case"namespace":return[];case"self-and-siblings":return t!=null&&t.nodeList?t.nodeList.filter(r=>r.nodeType!==2):[e];default:return[]}}getChildNodes(e){return Array.from(e.childNodes||[]).filter(r=>r.nodeType!==2)}getDescendants(e,t){let r=[];t&&r.push(e);let n=s=>{for(let o of this.getChildNodes(s))r.push(o),n(o)};return n(e),r}getAncestors(e,t){let r=[];t&&r.push(e);let n=e.parentNode;for(;n;)r.push(n),n=n.parentNode;return r}getFollowingSiblings(e){let t=[],r=e.nextSibling;for(;r;)t.push(r),r=r.nextSibling;return t}getPrecedingSiblings(e){let t=[],r=e.previousSibling;for(;r;)t.unshift(r),r=r.previousSibling;return t}getFollowing(e){let t=[],r=e.nextSibling;for(;r;)t.push(r),t.push(...this.getDescendants(r,!1)),r=r.nextSibling;let n=e.parentNode;for(;n;){for(r=n.nextSibling;r;)t.push(r),t.push(...this.getDescendants(r,!1)),r=r.nextSibling;n=n.parentNode}return t}getPreceding(e){let t=[],r=e.previousSibling;for(;r;){t.unshift(r);let s=this.getDescendants(r,!1);t.unshift(...s),r=r.previousSibling}let n=e.parentNode;for(;n;){for(r=n.previousSibling;r;){t.unshift(r);let s=this.getDescendants(r,!1);t.unshift(...s),r=r.previousSibling}n=n.parentNode}return t}matchesNodeTest(e,t){var n,s;let r=e.nodeType;switch(this.nodeTest.type){case"wildcard":if(this.nodeTest.name&&this.nodeTest.name.endsWith(":*")){let u=this.nodeTest.name.slice(0,-2),c=(n=t==null?void 0:t.namespaces)==null?void 0:n[u];if(!c)return!1;let d=e.namespaceURI||e.namespaceUri||"";return(r===1||r===2)&&d===c}return r===1||r===2;case"name":if(r!==1&&r!==2)return!1;let o=this.nodeTest.name,a=o.indexOf(":");if(a>0){let u=o.substring(0,a),c=o.substring(a+1),d=(s=t==null?void 0:t.namespaces)==null?void 0:s[u];if(!d)return!1;let h=e.localName||e.nodeName&&this.extractLocalName(e.nodeName),m=e.namespaceURI||e.namespaceUri||"";return h===c&&m===d}return(e.localName||this.extractLocalName(e.nodeName))===o;case"node-type":switch(this.nodeTest.nodeType){case"node":return!0;case"text":return r===3;case"comment":return r===8;case"processing-instruction":return r===7;default:return!1}case"processing-instruction":return r!==7?!1:this.nodeTest.name?e.target===this.nodeTest.name:!0;default:return!1}}applyPredicates(e,t){let r=e;for(let n of this.predicates){let s=[],o=r.length;for(let a=0;a<r.length;a++){let l=me(se({},t),{node:r[a],position:a+1,size:o}),u=n.evaluate(l);typeof u=="number"?u===a+1&&s.push(r[a]):this.toBoolean(u)&&s.push(r[a])}r=s}return r}toBoolean(e){return typeof e=="boolean"?e:typeof e=="number"?e!==0&&!isNaN(e):typeof e=="string"||Array.isArray(e)?e.length>0:!!e}extractLocalName(e){if(!e)return"";let t=e.indexOf(":");return t>0?e.substring(t+1):e}};var Ge=class extends T{constructor(e){super(),this.expression=e}evaluate(e){return this.expression.evaluate(e)}test(e){let t=this.evaluate(e);return typeof t=="number"?t===(e==null?void 0:e.position):this.toBoolean(t)}toBoolean(e){return typeof e=="boolean"?e:typeof e=="number"?e!==0&&!isNaN(e):typeof e=="string"||Array.isArray(e)?e.length>0:!!e}};var Y=class extends T{constructor(e,t=!1){super(),this.steps=e,this.absolute=t}evaluate(e){let t;if(this.absolute){let r=this.getDocumentRoot(e==null?void 0:e.node);t=r?[r]:[]}else t=e!=null&&e.node?[e.node]:[];for(let r of this.steps){let n=[];for(let s of t){let o=me(se({},e),{node:s}),a=r.evaluate(o);n.push(...a)}t=this.uniqueNodes(n)}return t}getDocumentRoot(e){if(!e)return null;let t=e;for(;t.parentNode;)t=t.parentNode;return t}uniqueNodes(e){let t=new Set,r=[];for(let n of e)t.has(n)||(t.add(n),r.push(n));return r}};var Te=class extends T{constructor(e,t){super(),this.expression=e,this.predicate=t}evaluate(e){return[]}};var ce=class extends T{constructor(e,t){super(),this.left=e,this.right=t}evaluate(e){let t=this.left.evaluate(e),r=this.right.evaluate(e),n=Array.isArray(t)?t:[],s=Array.isArray(r)?r:[];return this.unionNodes(n,s)}unionNodes(e,t){let r=new Set,n=[];for(let s of e)r.has(s)||(r.add(s),n.push(s));for(let s of t)r.has(s)||(r.add(s),n.push(s));return this.sortByDocumentOrder(n)}sortByDocumentOrder(e){return e.sort((t,r)=>{if(t===r)return 0;if(typeof t.compareDocumentPosition=="function"){let n=t.compareDocumentPosition(r);if(n&4)return-1;if(n&2)return 1}return 0})}};var he={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_FRAGMENT_NODE:11};function je(i,e){return se({node:i,position:1,size:1},e)}var de=class{constructor(){this.elementId=0}convert(e,t){if(e==null)return null;typeof e!="string"&&(e=String(e));let r=e.trim();if(r==="")return null;try{let n=JSON.parse(r);return this.createDocumentNode(n,t)}catch(n){if(t!=null&&t.fallback&&typeof t.fallback=="function")try{let s=t.fallback(r);return this.createDocumentNode(s,t)}catch(s){return null}return t!=null&&t.liberal?this.liberalParse(r,t):null}}createDocumentNode(e,t){this.elementId=0;let r=this.valueToElement(e,"root",t),n={nodeType:he.DOCUMENT_NODE,nodeName:"#document",localName:"#document",childNodes:[r],documentElement:r};return r.ownerDocument=n,n}valueToElement(e,t,r,n){let s={nodeType:he.ELEMENT_NODE,nodeName:t,localName:t,childNodes:[],attributes:[]};if(e==null)return s;if(typeof e=="object"&&!Array.isArray(e)){let o=[],a=new Set;for(let l in e)if(Object.prototype.hasOwnProperty.call(e,l)){if(a.has(l)){if((r==null?void 0:r.duplicates)==="reject")throw new Error(`Duplicate key: ${l}`);if((r==null?void 0:r.duplicates)==="use-first")continue}a.add(l);let u=this.sanitizeElementName(l),c=this.valueToElement(e[l],u,r,s);o.push(c)}s.childNodes=o}else if(Array.isArray(e)){let o=e.map((a,l)=>this.valueToElement(a,"item",r,s));s.childNodes=o}else if(typeof e=="string"){let o={nodeType:he.TEXT_NODE,nodeName:"#text",localName:"#text",textContent:e};s.childNodes=[o],s.textContent=e}else if(typeof e=="number"){let o=String(e),a={nodeType:he.TEXT_NODE,nodeName:"#text",localName:"#text",textContent:o};s.childNodes=[a],s.textContent=o}else if(typeof e=="boolean"){let o=e?"true":"false",a={nodeType:he.TEXT_NODE,nodeName:"#text",localName:"#text",textContent:o};s.childNodes=[a],s.textContent=o}return s}sanitizeElementName(e){if(/^[a-zA-Z_][\w.-]*$/.test(e))return e;let t=e.replace(/[^a-zA-Z0-9_.-]/g,"_");return/^[a-zA-Z_]/.test(t)||(t="_"+t),(!t||t==="_")&&(t="item"),t}liberalParse(e,t){try{let r=e.replace(/,(\s*[}\]])/g,"$1");r=r.replace(/'/g,'"');let n=JSON.parse(r);return this.createDocumentNode(n,t)}catch(r){return null}}};var ze=class extends T{constructor(t,r){super();this.jsonConverter=new de;this.name=t,this.args=r}evaluate(t){var n,s;let r=this.args.map(o=>o.evaluate(t));switch(this.name){case"last":return(n=t.size)!=null?n:0;case"position":return(s=t.position)!=null?s:0;case"count":return Array.isArray(r[0])?r[0].length:0;case"local-name":return this.localName(r,t);case"namespace-uri":return this.namespaceUri(r,t);case"name":return this.nodeName(r,t);case"string":return this.stringValue(r,t);case"concat":return r.map(String).join("");case"starts-with":return String(r[0]).startsWith(String(r[1]));case"contains":return String(r[0]).includes(String(r[1]));case"substring-before":return this.substringBefore(r);case"substring-after":return this.substringAfter(r);case"substring":return this.substring(r);case"string-length":return this.stringLength(r,t);case"normalize-space":return this.normalizeSpace(r,t);case"translate":return this.translate(r);case"boolean":return this.toBoolean(r[0]);case"not":return!this.toBoolean(r[0]);case"true":return!0;case"false":return!1;case"lang":return this.lang(r,t);case"number":return this.toNumber(r,t);case"sum":return this.sum(r);case"floor":return Math.floor(Number(r[0]));case"ceiling":return Math.ceil(Number(r[0]));case"round":return Math.round(Number(r[0]));case"json-to-xml":return this.jsonToXml(r,t);default:if(t.functions&&typeof t.functions[this.name]=="function")return t.functions[this.name](...r);throw new Error(`Unknown function: ${this.name}`)}}toBoolean(t){return typeof t=="boolean"?t:typeof t=="number"?t!==0&&!isNaN(t):typeof t=="string"||Array.isArray(t)?t.length>0:!!t}toNumber(t,r){return t.length===0?Number(this.stringValue([],r)):Number(t[0])}stringValue(t,r){var s,o,a,l;if(t.length===0)return(o=(s=r.node)==null?void 0:s.textContent)!=null?o:"";let n=t[0];return Array.isArray(n)&&n.length>0?(l=(a=n[0])==null?void 0:a.textContent)!=null?l:String(n[0]):String(n)}stringLength(t,r){return t.length===0?this.stringValue([],r).length:String(t[0]).length}normalizeSpace(t,r){return(t.length===0?this.stringValue([],r):String(t[0])).trim().replace(/\s+/g," ")}substringBefore(t){let r=String(t[0]),n=String(t[1]),s=r.indexOf(n);return s===-1?"":r.substring(0,s)}substringAfter(t){let r=String(t[0]),n=String(t[1]),s=r.indexOf(n);return s===-1?"":r.substring(s+n.length)}substring(t){let r=String(t[0]),n=Math.round(Number(t[1]))-1;if(t.length===2)return r.substring(Math.max(0,n));let s=Math.round(Number(t[2])),o=Math.max(0,n),a=Math.min(s-(o-n),r.length-o);return r.substring(o,o+a)}translate(t){let r=String(t[0]),n=String(t[1]),s=String(t[2]),o="";for(let a of r){let l=n.indexOf(a);l===-1?o+=a:l<s.length&&(o+=s[l])}return o}localName(t,r){var s;let n=this.getNodeArg(t,r);return(s=n==null?void 0:n.localName)!=null?s:""}namespaceUri(t,r){var s;let n=this.getNodeArg(t,r);return(s=n==null?void 0:n.namespaceUri)!=null?s:""}nodeName(t,r){var s;let n=this.getNodeArg(t,r);return(s=n==null?void 0:n.nodeName)!=null?s:""}getNodeArg(t,r){return t.length>0&&Array.isArray(t[0])&&t[0].length>0?t[0][0]:r.node}sum(t){let r=t[0];return Array.isArray(r)?r.reduce((n,s)=>{var a;let o=Number((a=s==null?void 0:s.textContent)!=null?a:s);return n+(isNaN(o)?0:o)},0):0}lang(t,r){var o,a;let n=String(t[0]).toLowerCase(),s=r.node;for(;s;){let l=((o=s.getAttribute)==null?void 0:o.call(s,"xml:lang"))||((a=s.getAttribute)==null?void 0:a.call(s,"lang"));if(l){let u=l.toLowerCase();return u===n||u.startsWith(n+"-")}s=s.parentNode}return!1}jsonToXml(t,r){if(r.xsltVersion&&r.xsltVersion!=="3.0")throw new Error('json-to-xml() is only supported in XSLT 3.0. Use version="3.0" in your stylesheet.');let n=t.length>0?String(t[0]):null,s;t.length>1&&typeof t[1]=="object"&&t[1]!==null&&(s=this.mapToOptions(t[1]));let o=this.jsonConverter.convert(n,s);return o?[o]:[]}mapToOptions(t){let r={};if(t.liberal!==void 0&&(r.liberal=!!t.liberal),t.duplicates!==void 0){let n=String(t.duplicates).toLowerCase();(n==="reject"||n==="use-first"||n==="retain")&&(r.duplicates=n)}return t.validate!==void 0&&(r.validate=!!t.validate),t.escape!==void 0&&(r.escape=!!t.escape),t.fallback!==void 0&&typeof t.fallback=="function"&&(r.fallback=t.fallback),r}};var pe=class{constructor(){this.tokens=[];this.current=0}parse(e){if(this.tokens=e,this.current=0,e.length===0)throw new Error("Empty expression");let t=this.parseExpr();if(!this.isAtEnd())throw new Error(`Unexpected token: ${this.peek().lexeme}`);return t}peek(){return this.tokens[this.current]}peekNext(){return this.tokens[this.current+1]}previous(){return this.tokens[this.current-1]}isAtEnd(){return this.current>=this.tokens.length}advance(){return this.isAtEnd()||this.current++,this.previous()}check(e){return this.isAtEnd()?!1:this.peek().type===e}checkLexeme(e){return this.isAtEnd()?!1:this.peek().lexeme===e}match(...e){for(let t of e)if(this.check(t))return this.advance(),!0;return!1}consume(e,t){var r,n;if(this.check(e))return this.advance();throw new Error(`${t}. Got: ${(n=(r=this.peek())==null?void 0:r.lexeme)!=null?n:"EOF"}`)}parseExpr(){return this.parseOrExpr()}parseOrExpr(){let e=this.parseAndExpr();for(;this.check("OPERATOR")&&this.peek().lexeme==="or";){this.advance();let t=this.parseAndExpr();e=new Ee(e,t,"or")}return e}parseAndExpr(){let e=this.parseEqualityExpr();for(;this.check("OPERATOR")&&this.peek().lexeme==="and";){this.advance();let t=this.parseEqualityExpr();e=new Ee(e,t,"and")}return e}parseEqualityExpr(){let e=this.parseRelationalExpr();for(;this.match("EQUALS","NOT_EQUALS");){let t=this.previous().lexeme,r=this.parseRelationalExpr();e=new ye(e,r,t)}return e}parseRelationalExpr(){let e=this.parseAdditiveExpr();for(;this.match("LESS_THAN","GREATER_THAN","LESS_THAN_OR_EQUAL","GREATER_THAN_OR_EQUAL");){let t=this.previous().lexeme,r=this.parseAdditiveExpr();e=new ye(e,r,t)}return e}parseAdditiveExpr(){let e=this.parseMultiplicativeExpr();for(;this.match("PLUS","MINUS");){let t=this.previous().lexeme,r=this.parseMultiplicativeExpr();e=new ue(e,r,t)}return e}parseMultiplicativeExpr(){let e=this.parseUnaryExpr();for(;;)if(this.match("ASTERISK")){let t=this.parseUnaryExpr();e=new ue(e,t,"*")}else if(this.check("OPERATOR")&&(this.peek().lexeme==="div"||this.peek().lexeme==="mod")){let t=this.advance().lexeme,r=this.parseUnaryExpr();e=new ue(e,r,t)}else break;return e}parseUnaryExpr(){if(this.match("MINUS")){let e=this.parseUnaryExpr();return new Be("-",e)}return this.parseUnionExpr()}parseUnionExpr(){let e=this.parsePathExpr();for(;this.match("PIPE");){let t=this.parsePathExpr();e=new ce(e,t)}return e}parsePathExpr(){if(this.check("SLASH")||this.check("DOUBLE_SLASH"))return this.parseLocationPath();if(this.isStepStart())return this.parseLocationPath();let e=this.parseFilterExpr();if(this.match("SLASH","DOUBLE_SLASH")){let t=this.previous().type==="DOUBLE_SLASH",r=this.parseRelativeLocationPath();return t&&r.unshift(new G("descendant-or-self",{type:"node-type",nodeType:"node"})),new Te(e,new Y(r,!1))}return e}isStepStart(){if(this.isAtEnd())return!1;let e=this.peek();if(e.type==="DOT"||e.type==="DOT_DOT"||e.type==="AT"||e.type==="LOCATION"||e.type==="NODE_TYPE"||e.type==="ASTERISK")return!0;if(e.type==="IDENTIFIER"||e.type==="OPERATOR"||e.type==="FUNCTION"){let t=this.peekNext();return!t||t.type!=="OPEN_PAREN"}return!1}parseLocationPath(){let e=!1,t=[];return this.match("SLASH")?(e=!0,!this.isAtEnd()&&this.isStepStart()&&t.push(...this.parseRelativeLocationPath())):this.match("DOUBLE_SLASH")?(e=!0,t.push(new G("descendant-or-self",{type:"node-type",nodeType:"node"})),t.push(...this.parseRelativeLocationPath())):t.push(...this.parseRelativeLocationPath()),new Y(t,e)}parseRelativeLocationPath(){let e=[];for(e.push(this.parseStep());this.match("SLASH","DOUBLE_SLASH");)this.previous().type==="DOUBLE_SLASH"&&e.push(new G("descendant-or-self",{type:"node-type",nodeType:"node"})),e.push(this.parseStep());return e}parseStep(){if(this.match("DOT"))return new G("self",{type:"node-type",nodeType:"node"});if(this.match("DOT_DOT"))return new G("parent",{type:"node-type",nodeType:"node"});let e="child";if(this.match("AT"))e="attribute";else if(this.check("LOCATION")){let n=this.peekNext();n&&n.type==="COLON_COLON"&&(e=this.advance().lexeme,this.advance())}let t=this.parseNodeTest(),r=this.parsePredicates();return new G(e,t,r)}parseNodeTest(){var e,t;if(this.match("ASTERISK"))return{type:"wildcard"};if(this.check("NODE_TYPE")){let r=this.peekNext();if(r&&r.type==="OPEN_PAREN"){let n=this.advance().lexeme;if(this.advance(),n==="processing-instruction"&&this.check("STRING")){let s=this.advance().lexeme;return this.consume("CLOSE_PAREN","Expected ')' after processing-instruction name"),{type:"processing-instruction",name:s}}return this.consume("CLOSE_PAREN","Expected ')' after node type"),{type:"node-type",nodeType:n}}}if(this.check("IDENTIFIER")||this.check("LOCATION")||this.check("FUNCTION")||this.check("NODE_TYPE")||this.check("OPERATOR")){let r=this.advance().lexeme;if(this.match("COLON")){if(this.match("ASTERISK"))return{type:"wildcard",name:`${r}:*`};if(this.check("IDENTIFIER")||this.check("LOCATION")||this.check("FUNCTION")||this.check("NODE_TYPE")||this.check("OPERATOR")){let n=this.advance().lexeme;return{type:"name",name:`${r}:${n}`}}throw new Error("Expected local name after namespace prefix")}return{type:"name",name:r}}throw new Error(`Expected node test, got: ${(t=(e=this.peek())==null?void 0:e.lexeme)!=null?t:"EOF"}`)}parsePredicates(){let e=[];for(;this.match("OPEN_SQUARE_BRACKET");){let t=this.parseExpr();this.consume("CLOSE_SQUARE_BRACKET","Expected ']' after predicate"),e.push(new Ge(t))}return e}parseFilterExpr(){let e=this.parsePrimaryExpr();for(;this.check("OPEN_SQUARE_BRACKET");){let t=this.parsePredicates();for(let r of t)e=new Te(e,r)}return e}parsePrimaryExpr(){var e,t;if(this.match("DOLLAR")){let r=this.consume("IDENTIFIER","Expected variable name after $").lexeme;return new $e(r)}if(this.match("OPEN_PAREN")){let r=this.parseExpr();return this.consume("CLOSE_PAREN","Expected ')' after expression"),r}if(this.check("STRING")){let r=this.advance().lexeme;return new ke(r)}if(this.check("NUMBER")){let r=parseFloat(this.advance().lexeme);return new Ue(r)}if(this.check("FUNCTION")||this.check("IDENTIFIER")){let r=this.peekNext();if(r&&r.type==="OPEN_PAREN")return this.parseFunctionCall()}throw new Error(`Unexpected token in primary expression: ${(t=(e=this.peek())==null?void 0:e.lexeme)!=null?t:"EOF"}`)}parseFunctionCall(){let e=this.advance().lexeme;this.consume("OPEN_PAREN","Expected '(' after function name");let t=[];if(!this.check("CLOSE_PAREN"))do t.push(this.parseExpr());while(this.match("COMMA"));return this.consume("CLOSE_PAREN","Expected ')' after function arguments"),new ze(e,t)}};var L=class{constructor(e){this.value=e,this.type="string"}stringValue(){return String(this.value)}booleanValue(){return this.value.length>0}numberValue(){return this.value-0}nodeSetValue(){throw this}};var j=class{constructor(e){this.value=e,this.type="number"}stringValue(){return`${this.value}`}booleanValue(){return!!this.value}numberValue(){return this.value-0}nodeSetValue(){throw this}};var E=class{constructor(e){this.value=e,this.type="boolean"}stringValue(){return`${this.value}`}booleanValue(){return this.value}numberValue(){return this.value?1:0}nodeSetValue(){throw this}};ae();var _=class{constructor(e){this.value=e,this.type="node-set"}stringValue(){return this.value.length===0?"":B(this.value[0])}booleanValue(){return this.value.length>0}numberValue(){return parseInt(this.stringValue())-0}nodeSetValue(){return this.value}};var fe=class{constructor(e,t){this.xpathExpression=e,this.nodeConverter=t,e instanceof Y&&(this.absolute=e.absolute,this.steps=e.steps.map((r,n)=>({axis:r.axis,nodeTest:r.nodeTest,predicates:r.predicates,hasPositionalPredicate:!1,predicate:r.predicates||[],evaluate:s=>{let o=this.nodeConverter.exprContextToXPathContext(s),a=r.evaluate(o);return this.nodeConverter.wrapResult(a,s)}})))}evaluate(e){let t=this.nodeConverter.exprContextToXPathContext(e),r=this.xpathExpression.evaluate(t);return this.nodeConverter.wrapResult(r,e)}},q=class extends fe{constructor(e,t){super(e,t),this.absolute=e.absolute,this.steps=e.steps.map(r=>({axis:r.axis,nodeTest:r.nodeTest,predicates:r.predicates||[],predicate:r.predicates||[],hasPositionalPredicate:this.hasPositionalPredicate(r.predicates||[])}))}hasPositionalPredicate(e){return!1}appendStep(e){this.steps.push(e)}prependStep(e){this.steps.unshift(e)}},K=class extends fe{constructor(e,t,r,n){super(e,t),this.expr1=r,this.expr2=n}},ot=class{exprContextToXPathContext(e){let t=e.nodeList[e.position],r=this.adaptXNode(t),n=e.nodeList.map(s=>this.adaptXNode(s));return je(r,{position:e.position+1,size:e.nodeList.length,nodeList:n,variables:this.convertVariables(e),functions:this.createCustomFunctions(e),namespaces:e.knownNamespaces,xsltVersion:e.xsltVersion})}adaptXNode(e){if(!e)return null;let t=e;return"textContent"in t||Object.defineProperty(t,"textContent",{get(){return this._getTextContent()},enumerable:!0,configurable:!0}),"_getTextContent"in t||(t._getTextContent=function(){if(this.nodeType===3||this.nodeType===2)return this.nodeValue||"";if(!this.childNodes)return"";let r="";for(let n of this.childNodes)n.nodeType===3?r+=n.nodeValue||"":n.nodeType===1&&(r+=this._getTextContent.call(n));return r}),"attributes"in t||Object.defineProperty(t,"attributes",{get(){return this.childNodes?this.childNodes.filter(r=>r.nodeType===2):[]},enumerable:!0,configurable:!0}),"getAttribute"in t||(t.getAttribute=function(r){return this.getAttributeValue?this.getAttributeValue(r):null}),t}xPathNodeToXNode(e){return e?e instanceof O?e:this.convertXPathNodeToXNode(e):null}getTextContent(e){if(e.nodeType===3||e.nodeType===2)return e.nodeValue||"";if(!e.childNodes)return"";let t="";for(let r of e.childNodes)r.nodeType===3?t+=r.nodeValue||"":r.nodeType===1&&(t+=this.getTextContent(r));return t}convertVariables(e){let t={};for(let[r,n]of Object.entries(e.variables||{}))if(n&&typeof n=="object"&&"stringValue"in n){let s=n;s.type==="node-set"?t[r]=n.nodeSetValue().map(o=>this.adaptXNode(o)):s.type==="string"?t[r]=n.stringValue():s.type==="number"?t[r]=n.numberValue():s.type==="boolean"?t[r]=n.booleanValue():t[r]=n.stringValue()}else t[r]=n;return t}createCustomFunctions(e){let t={};return t.key=(r,n)=>{var o;let s=(o=e.keys)==null?void 0:o[r];return s&&s[n]?s[n].nodeSetValue().map(l=>this.adaptXNode(l)):[]},t.current=()=>{let r=e.nodeList[e.position];return[this.adaptXNode(r)]},t["format-number"]=(r,n,s)=>{let o=e.decimalFormatSettings;return r.toLocaleString()},t["xml-to-json"]=r=>{if(e.xsltVersion!=="3.0")throw new Error('xml-to-json() is only supported in XSLT 3.0. Use version="3.0" in your stylesheet.');let n=Array.isArray(r)?r[0]:r;return n?this.xmlToJson(n):'""'},t["json-to-xml"]=r=>{if(e.xsltVersion!=="3.0")throw new Error('json-to-xml() is only supported in XSLT 3.0. Use version="3.0" in your stylesheet.');let n=Array.isArray(r)?r[0]:r;if(!n)return[];let o=new de().convert(String(n));if(!o)return null;let a=e.nodeList&&e.nodeList.length>0?e.nodeList[0].ownerDocument:null,l=this.convertXPathNodeToXNode(o,a);return l?[l]:[]},t}convertXPathNodeToXNode(e,t){if(!e)return null;let{XNode:r}=(ae(),Ye(Rt)),{DOM_DOCUMENT_NODE:n,DOM_TEXT_NODE:s,DOM_ELEMENT_NODE:o}=(D(),Ye(ft)),a;if(e.nodeType===n){if(e.childNodes&&e.childNodes.length>0){let l=e.childNodes[0];return a=this.convertXPathNodeToXNode(l,t),a}return null}else if(e.nodeType===s){let l=e.textContent||"";a=new r(s,"#text",l,t)}else if(a=new r(o,e.nodeName||"element","",t),e.namespaceUri&&(a.namespaceUri=e.namespaceUri),e.childNodes&&e.childNodes.length>0){for(let l=0;l<e.childNodes.length;l++){let u=e.childNodes[l],c=this.convertXPathNodeToXNode(u,t);c&&(c.parentNode=a,a.childNodes.push(c))}a.childNodes.length>0&&(a.firstChild=a.childNodes[0],a.lastChild=a.childNodes[a.childNodes.length-1])}return a}xmlToJson(e){if(!e)return'""';if(e.nodeType===3){let t=e.nodeValue||"";return JSON.stringify(t)}if(e.nodeType===1){let t=this.getTextContent(e);return JSON.stringify(t)}return e.nodeType===2?JSON.stringify(e.nodeValue||""):'""'}wrapResult(e,t){if(Array.isArray(e)){let r=e.map(n=>this.xPathNodeToXNode(n)).filter(n=>n!==null);return new _(r)}return typeof e=="string"?new L(e):typeof e=="number"?new j(e):typeof e=="boolean"?new E(e):new _([])}clearCache(){}},re=class{constructor(){this.parseCache=new Map;this.lexer=new le,this.parser=new pe,this.nodeConverter=new ot}xPathParse(e,t){let r=`${e}:${t||""}`;if(this.parseCache.has(r))return this.parseCache.get(r);let n=this.lexer.scan(e),s=this.parser.parse(n),o=this.wrapExpression(s,t);return this.parseCache.set(r,o),o}xPathEval(e,t){return this.xPathParse(e).evaluate(t)}xPathSort(e,t){if(t.length===0)return;let r=[];for(let s=0;s<e.contextSize();++s){let o=e.nodeList[s],a={node:o,key:[]},l=e.clone([o],0);for(let u of t){let c=u.expr.evaluate(l),d;u.type==="text"?d=c.stringValue():u.type==="number"&&(d=c.numberValue()),a.key.push({value:d,order:u.order})}a.key.push({value:s,order:"ascending"}),r.push(a)}r.sort(this.xPathSortByKey);let n=[];for(let s=0;s<r.length;++s){let o=r[s].node;o.siblingPosition=s,n.push(o)}e.nodeList=n,e.setNode(0)}xPathSortByKey(e,t){for(let r=0;r<e.key.length;++r){let n=e.key[r].order==="descending"?-1:1;if(e.key[r].value>t.key[r].value)return 1*n;if(e.key[r].value<t.key[r].value)return-1*n}return 0}wrapExpression(e,t){if(e instanceof Y)return t&&e.steps.length>0&&!e.absolute&&(e.steps[0].axis=t),new q(e,this.nodeConverter);if(e instanceof ce){let r=this.wrapExpression(e.left,t),n=this.wrapExpression(e.right,t);return new K(e,this.nodeConverter,r,n)}return new fe(e,this.nodeConverter)}clearCache(){this.parseCache.clear(),this.nodeConverter.clearCache()}};D();var Mt={label:"[number]",prec:35,re:new RegExp("^\\d+(\\.\\d*)?"),key:void 0};var ne=class i{constructor(e,t="1.0",r,n,s,o,a,l,u,c,d){this.nodeList=e,this.xsltVersion=t,this.position=r||0,this.variables=s||{},this.keys=(a==null?void 0:a.keys)||{},this.knownNamespaces=o||{},this.parent=a||null,this.caseInsensitive=l||!1,this.ignoreAttributesWithoutValue=u||!1,this.returnOnFirstMatch=c||!1,this.ignoreNonElementNodesForNTA=d||!1,this.inApplyTemplates=!1,this.baseTemplateMatched=!1,this.decimalFormatSettings=n||{decimalSeparator:".",groupingSeparator:",",infinity:"Infinity",minusSign:"-",naN:"NaN",percent:"%",perMille:"\u2030",zeroDigit:"0",digit:"#",patternSeparator:";"},a?this.root=a.root:this.nodeList[this.position].nodeType==9?this.root=this.nodeList[this.position]:this.root=this.nodeList[this.position].ownerDocument}clone(e,t){return new i(e||this.nodeList,this.xsltVersion,typeof t!="undefined"?t:this.position,this.decimalFormatSettings,this.variables,this.knownNamespaces,this,this.caseInsensitive,this.ignoreAttributesWithoutValue,this.returnOnFirstMatch,this.ignoreNonElementNodesForNTA)}setVariable(e,t){if(t instanceof L||t instanceof E||t instanceof j||t instanceof _){this.variables[e]=t;return}t==="true"?this.variables[e]=new E(!0):t==="false"?this.variables[e]=new E(!1):Mt.re.test(String(t))?this.variables[e]=new j(t):this.variables[e]=new L(t)}getVariable(e){return typeof this.variables[e]!="undefined"?this.variables[e]:this.parent?this.parent.getVariable(e):null}setNode(e){this.position=e}contextSize(){return this.nodeList.length}isCaseInsensitive(){return this.caseInsensitive}setCaseInsensitive(e){return this.caseInsensitive=e}isIgnoreAttributesWithoutValue(){return this.ignoreAttributesWithoutValue}setIgnoreAttributesWithoutValue(e){return this.ignoreAttributesWithoutValue=e}isReturnOnFirstMatch(){return this.returnOnFirstMatch}setReturnOnFirstMatch(e){return this.returnOnFirstMatch=e}isIgnoreNonElementNodesForNTA(){return this.ignoreNonElementNodesForNTA}setIgnoreNonElementNodesForNTA(e){return this.ignoreNonElementNodesForNTA=e}};var be=class{expressionMatch(e,t){if(e instanceof q)return this.locationExpressionMatch(e,t);if(e instanceof K)return this.unionExpressionMatch(e,t);try{return e.evaluate(t).nodeSetValue()}catch(r){return[]}}locationExpressionMatch(e,t){if(!e.steps||e.steps.length<=0){if(e.absolute){let r=t.nodeList[t.position];return r.nodeName==="#document"?[r]:[]}return[t.nodeList[t.position]]}return e.absolute?e.steps[0].axis==="self"?this.absoluteXsltMatchByDocumentNode(e,t):this.absoluteXsltMatch(e,t):this.relativeXsltMatch(e,t)}unionExpressionMatch(e,t){return this.expressionMatch(e.expr1,t).concat(this.expressionMatch(e.expr2,t))}absoluteXsltMatchByDocumentNode(e,t){let r=t.clone([t.root],0),n=e.evaluate(r).nodeSetValue(),s=[];for(let o of n)o.id===t.nodeList[t.position].id&&s.push(o);return s}absoluteXsltMatch(e,t){var l;let r=t.root.childNodes.find(u=>u.nodeName!=="#dtd-section");if(!r)return[];let n=t.clone([r],0),s=e.evaluate(n).nodeSetValue(),o=[],a;t.nodeList.length===1&&t.nodeList[0].nodeName==="#document"?a=[t.nodeList[0].childNodes.find(u=>u.nodeName!=="#dtd-section")]:a=t.nodeList;for(let u of s)u.id===((l=a[t.position])==null?void 0:l.id)&&o.push(u);return o}relativeXsltMatch(e,t){let r=t.clone(),n=e.evaluate(r).nodeSetValue();return n.length===1&&n[0].nodeName==="#document"?[n[0].childNodes[0]]:n}};var Xe=class{constructor(){this.value=new E(!0)}evaluate(){return this.value}};D();var Pe=class{evaluate(e){return new E(e.nodeList[e.position].nodeType==8)}};D();var Ce=class{evaluate(e){let t=e.nodeList[e.position];return new E(t.nodeType==1||t.nodeType==2)}};var ve=class{constructor(e){if(this.name=e,e.indexOf(":")>0){let t=e.split(":");this.namespacePrefix=t[0],this.name=t[1]}this.re=new RegExp(`^${e}$`,"i")}evaluate(e){let t=e.nodeList[e.position];return this.namespacePrefix!==void 0?e.knownNamespaces[this.namespacePrefix]!==t.namespaceUri?new E(!1):e.caseInsensitive?t.localName.length!==this.name.length?new E(!1):new E(this.re.test(t.localName)):new E(t.localName===this.name):e.caseInsensitive?t.nodeName.length!==this.name.length?new E(!1):new E(this.re.test(t.nodeName)):new E(t.nodeName===this.name)}};var Oe=class{constructor(e){this.regex=new RegExp(`^${e}:`),this.nsprefix=e}evaluate(e){let t=e.nodeList[e.position];return new E(t.nodeName.match(this.regex))}};D();var Se=class{constructor(e){this.target=e}evaluate(e){let t=e.nodeList[e.position];return new E(t.nodeType==7&&(!this.target||t.nodeName==this.target))}};D();var Ae=class{evaluate(e){return new E(e.nodeList[e.position].nodeType==3)}};ae();D();D();function ar(i){let e=i.nodeTest;if(i.predicate&&i.predicate.length>0||i.predicates&&i.predicates.length>0)return .5;if(e&&typeof e=="object"&&"type"in e)switch(e.type){case"wildcard":return e.name&&e.name.endsWith(":*")?-.25:-.5;case"node-type":return e.nodeType==="processing-instruction"&&e.name?0:-.5;case"processing-instruction":return e.name?0:-.5;case"name":return 0;default:return 0}return e instanceof Xe||e instanceof Ce||e instanceof Ae||e instanceof Pe?-.5:e instanceof Se?e.target?0:-.5:e instanceof Oe?-.25:(e instanceof ve,0)}function lr(i){return!i.steps||i.steps.length===0?i.absolute?-.5:0:i.steps.length>1?.5:ar(i.steps[0])}function ur(i,e){let t=at(i.expr1,e),r=at(i.expr2,e);return Math.min(t,r)}function at(i,e){return i instanceof q?lr(i):i instanceof K?ur(i,e):.5}function cr(i,e){try{let t=e.xPathParse(i,"self-and-siblings");return at(t,e)}catch(t){return console.warn(`Failed to parse pattern "${i}" for priority calculation:`,t),0}}function hr(i,e){let t=i.getAttributeValue("mode");return e?e==="#all"||t==="#all"?!0:t===e:!t||t==="#default"}function dr(i){return i.nodeType!==1?!1:(i.namespaceUri==="http://www.w3.org/1999/XSL/Transform"||i.prefix==="xsl")&&i.localName==="template"}function lt(i,e,t){let r=[],n=0;for(let s of i.childNodes){if(!dr(s)||!hr(s,e))continue;let o=s.getAttributeValue("match");if(!o)continue;let a=s.getAttributeValue("priority"),l=a?parseFloat(a):null,u=cr(o,t),c=l!==null&&!isNaN(l)?l:u;r.push({template:s,explicitPriority:l!==null&&!isNaN(l)?l:null,defaultPriority:u,effectivePriority:c,importPrecedence:0,documentOrder:n++,matchPattern:o})}return r}function pr(i){let e=[],t="",r=0,n=!1,s=!1;for(let o=0;o<i.length;o++){let a=i[o];a==="'"&&!s?(n=!n,t+=a):a==='"'&&!n?(s=!s,t+=a):!n&&!s?a==="["||a==="("?(r++,t+=a):a==="]"||a===")"?(r--,t+=a):a==="|"&&r===0?(e.push(t.trim()),t=""):t+=a:t+=a}return t.trim()&&e.push(t.trim()),e}function fr(i,e,t,r,n){if(e==="/")return i.nodeName==="#document";if(e.startsWith("@")){if(i.nodeType!==2)return!1;let s=e.substring(1);if(s==="*")return!0;let o=i.localName||i.nodeName,a=s.includes(":")?s.substring(s.indexOf(":")+1):s;return o===a||i.nodeName===s}if(e==="*"&&i.nodeType===1||!e.includes("/")&&!e.includes("[")&&!e.startsWith("@")&&(e===i.nodeName||e===i.localName))return!0;if(e.includes("/")||e.includes("["))try{let s=e.startsWith("/")?e:"//"+e,o=t.clone([t.root],0);if(n.xPathEval(s,o).nodeSetValue().some(u=>u.id===i.id))return!0}catch(s){}if(!e.includes("/")&&!e.includes("[")&&!e.startsWith("@"))try{let s=t.clone([i],0),o=n.xPathParse(e,"self-and-siblings");if(r.expressionMatch(o,s).some(l=>l.id===i.id))return!0}catch(s){}return!1}function mr(i,e,t,r,n){let s=pr(e);for(let o of s)if(fr(i,o,t,r,n))return!0;return!1}function We(i,e,t,r){let n=[],s=e.nodeList[e.position];for(let l of i)try{mr(s,l.matchPattern,e,t,r)&&n.push(l)}catch(u){console.warn(`Failed to match pattern "${l.matchPattern}":`,u)}if(n.length===0)return{selectedTemplate:null,hasConflict:!1,conflictingTemplates:[]};n.sort((l,u)=>l.importPrecedence!==u.importPrecedence?u.importPrecedence-l.importPrecedence:l.effectivePriority!==u.effectivePriority?u.effectivePriority-l.effectivePriority:u.documentOrder-l.documentOrder);let o=n[0],a=n.filter(l=>l.importPrecedence===o.importPrecedence&&l.effectivePriority===o.effectivePriority);return{selectedTemplate:o.template,hasConflict:a.length>1,conflictingTemplates:a.length>1?a:[]}}function Vt(i,e){if(!i.hasConflict||i.conflictingTemplates.length<2)return;let t=i.conflictingTemplates.map(r=>`"${r.matchPattern}" (priority: ${r.effectivePriority})`).join(", ");console.warn(`XSLT Warning: Ambiguous template match for node <${e.nodeName}>. Multiple templates match with equal priority: ${t}. Using the last one in document order.`)}var He=class{constructor(e={cData:!0,escape:!0,selfClosingTags:!0,parameters:[]}){this.xPath=new re,this.xmlParser=new te,this.matchResolver=new be,this.options={cData:e.cData===!0,escape:e.escape===!0,selfClosingTags:e.selfClosingTags===!0,outputMethod:e.outputMethod,parameters:e.parameters||[]},this.outputMethod=e.outputMethod||"xml",this.outputOmitXmlDeclaration="no",this.stripSpacePatterns=[],this.preserveSpacePatterns=[],this.namespaceAliases=new Map,this.decimalFormatSettings={decimalSeparator:".",groupingSeparator:",",infinity:"Infinity",minusSign:"-",naN:"NaN",percent:"%",perMille:"\u2030",zeroDigit:"0",digit:"#",patternSeparator:";"},this.firstTemplateRan=!1}xsltProcess(e,t){return X(this,null,function*(){let r=new H;this.outputDocument=r;let n=new ne([e]);if(this.options.parameters.length>0)for(let a of this.options.parameters)n.setVariable(a.name,new L(a.value));if(yield this.xsltProcessContext(n,t,this.outputDocument),this.outputMethod==="json")return st(r);let s=this.outputMethod;return this.outputMethod==="adaptive"&&(s=nt(r)),rt(r,{cData:this.options.cData,escape:this.options.escape,selfClosingTags:this.options.selfClosingTags,outputMethod:s})})}xsltProcessContext(e,t,r){return X(this,null,function*(){if(!this.isXsltElement(t))yield this.xsltPassThrough(e,t,r);else{let n,s,o,a;switch(t.localName){case"apply-imports":throw new Error(`not implemented: ${t.localName}`);case"apply-templates":yield this.xsltApplyTemplates(e,t,r);break;case"attribute":yield this.xsltAttribute(e,t,r);break;case"attribute-set":throw new Error(`not implemented: ${t.localName}`);case"call-template":yield this.xsltCallTemplate(e,t,r);break;case"choose":yield this.xsltChoose(e,t,r);break;case"comment":yield this.xsltComment(e,t,r);break;case"copy":n=this.xsltCopy(r||this.outputDocument,e.nodeList[e.position]),n&&(yield this.xsltChildNodes(e,t,n));break;case"copy-of":s=f(t,"select"),o=this.xPath.xPathEval(s,e);let l=r||this.outputDocument;if(o.type==="node-set"){a=o.nodeSetValue();for(let u=0;u<a.length;++u)this.xsltCopyOf(l,a[u])}else{let u=V(this.outputDocument,o.stringValue());u.siblingPosition=l.childNodes.length,P(l,u)}break;case"decimal-format":this.xsltDecimalFormat(e,t);break;case"element":yield this.xsltElement(e,t,r);break;case"fallback":throw new Error(`not implemented: ${t.localName}`);case"for-each":yield this.xsltForEach(e,t,r);break;case"if":yield this.xsltIf(e,t,r);break;case"import":yield this.xsltImport(e,t,r);break;case"include":yield this.xsltInclude(e,t,r);break;case"key":this.xsltKey(e,t);break;case"message":yield this.xsltMessage(e,t);break;case"namespace-alias":this.xsltNamespaceAlias(t);break;case"number":this.xsltNumber(e,t,r);break;case"otherwise":throw new Error("<xsl:otherwise> must be a child of <xsl:choose>.");case"output":this.outputMethod=f(t,"method"),this.outputOmitXmlDeclaration=f(t,"omit-xml-declaration");break;case"param":yield this.xsltVariable(e,t,!1);break;case"preserve-space":this.xsltPreserveSpace(t);break;case"processing-instruction":throw new Error(`not implemented: ${t.localName}`);case"sort":this.xsltSort(e,t);break;case"strip-space":this.xsltStripSpace(t);break;case"stylesheet":case"transform":yield this.xsltTransformOrStylesheet(e,t,r);break;case"template":yield this.xsltTemplate(e,t,r);break;case"text":this.xsltText(e,t,r);break;case"value-of":this.xsltValueOf(e,t,r);break;case"variable":yield this.xsltVariable(e,t,!0);break;case"when":throw new Error("<xsl:when> must be a child of <xsl:choose>.");case"with-param":throw new Error("<xsl:with-param> must be a child of <xsl:call-template> or <xsl:apply-templates>.");default:throw new Error(`error if here: ${t.localName}`)}}})}xsltApplyTemplates(e,t,r){return X(this,null,function*(){let n=f(t,"select"),s=[];n?s=this.xPath.xPathEval(n,e).nodeSetValue():s=e.nodeList[e.position].childNodes;let o=f(t,"mode"),a=t.ownerDocument.documentElement,l=lt(a,o,this.xPath),u=e.clone();yield this.xsltWithParam(u,t);let c=u.clone(s);for(let d=0;d<c.contextSize();++d){let h=c.nodeList[d];if(h.nodeType===3){if(!this.xsltPassText(h))continue;let m=e.clone([h],0);this.commonLogicTextNode(m,h,r)}else{let m=c.clone([h],0);m.inApplyTemplates=!0;let p=We(l,m,this.matchResolver,this.xPath);p.hasConflict&&Vt(p,h),p.selectedTemplate&&(yield this.xsltChildNodes(m,p.selectedTemplate,r))}}})}xsltAttribute(e,t,r){return X(this,null,function*(){let n=f(t,"name"),s=this.xsltAttributeValue(n,e),o=ie(this.outputDocument);yield this.xsltChildNodes(e,t,o);let a=tt(o);r&&$(r,s,a)})}xsltCallTemplate(e,t,r){return X(this,null,function*(){let n=f(t,"name"),s=t.ownerDocument.documentElement,o=e.clone();yield this.xsltWithParam(o,t);for(let a=0;a<s.childNodes.length;++a){let l=s.childNodes[a];if(l.nodeType===1&&this.isXsltElement(l,"template")&&Q(l,"name")===n){yield this.xsltChildNodes(o,l,r);break}}})}xsltChoose(e,t,r){return X(this,null,function*(){for(let n of t.childNodes)if(n.nodeType===1){if(this.isXsltElement(n,"when")){let s=f(n,"test");if(this.xPath.xPathEval(s,e).booleanValue()){yield this.xsltChildNodes(e,n,r);break}}else if(this.isXsltElement(n,"otherwise")){yield this.xsltChildNodes(e,n,r);break}}})}xsltCopy(e,t){if(t.nodeType==1){let r=z(this.outputDocument,t.nodeName);return t.namespaceUri!==null&&t.namespaceUri!==void 0&&$(r,"xmlns",t.namespaceUri),r.siblingPosition=e.childNodes.length,P(e,r),r}if(t.nodeType==3){if(this.shouldStripWhitespaceNode(t))return null;let r=V(this.outputDocument,t.nodeValue);r.siblingPosition=e.childNodes.length,P(e,r)}else if(t.nodeType==4){let r=Ne(this.outputDocument,t.nodeValue);r.siblingPosition=e.childNodes.length,P(e,r)}else if(t.nodeType==8){let r=Z(this.outputDocument,t.nodeValue);r.siblingPosition=e.childNodes.length,P(e,r)}else t.nodeType==2&&$(e,t.nodeName,t.nodeValue);return null}xsltComment(e,t,r){return X(this,null,function*(){let n=ie(this.outputDocument);yield this.xsltChildNodes(e,t,n);let s=B(n),o=Z(this.outputDocument,s);(r||this.outputDocument).appendChild(o)})}xsltCopyOf(e,t){if(t.nodeType==11||t.nodeType==9)for(let r=0;r<t.childNodes.length;++r)this.xsltCopyOf(e,t.childNodes[r]);else{let r=this.xsltCopy(e,t);if(r)for(let n=0;n<t.childNodes.length;++n)this.xsltCopyOf(r,t.childNodes[n])}}xsltDecimalFormat(e,t){let r=f(t,"name"),n=f(t,"decimal-separator"),s=f(t,"grouping-separator"),o=f(t,"infinity"),a=f(t,"minus-sign"),l=f(t,"NaN"),u=f(t,"percent"),c=f(t,"per-mille"),d=f(t,"zero-digit"),h=f(t,"digit"),m=f(t,"pattern-separator");this.decimalFormatSettings={name:r||this.decimalFormatSettings.name,decimalSeparator:n||this.decimalFormatSettings.decimalSeparator,groupingSeparator:s||this.decimalFormatSettings.groupingSeparator,infinity:o||this.decimalFormatSettings.infinity,minusSign:a||this.decimalFormatSettings.minusSign,naN:l||this.decimalFormatSettings.naN,percent:u||this.decimalFormatSettings.percent,perMille:c||this.decimalFormatSettings.perMille,zeroDigit:d||this.decimalFormatSettings.zeroDigit,digit:h||this.decimalFormatSettings.digit,patternSeparator:m||this.decimalFormatSettings.patternSeparator},e.decimalFormatSettings=this.decimalFormatSettings}xsltElement(e,t,r){return X(this,null,function*(){let n=f(t,"name"),s=this.xsltAttributeValue(n,e),o=z(this.outputDocument,s);P(r||this.outputDocument,o);let a=e.clone(void 0,0);yield this.xsltChildNodes(a,t,o)})}xsltForEach(e,t,r){return X(this,null,function*(){let n=f(t,"select"),s=this.xPath.xPathEval(n,e).nodeSetValue();if(s.length===0)return;let o=e.clone(s);if(this.xsltSort(o,t),o.nodeList.filter(l=>l.parentNode!==null&&l.parentNode!==void 0).length<=0)throw new Error("Nodes with no parents defined.");for(let l=0;l<o.contextSize();++l)yield this.xsltChildNodes(o.clone(o.nodeList,l),t,r)})}xsltIf(e,t,r){return X(this,null,function*(){let n=f(t,"test");this.xPath.xPathEval(n,e).booleanValue()&&(yield this.xsltChildNodes(e,t,r))})}xsltImportOrInclude(e,t,r,n){return X(this,null,function*(){let s=n?"xsl:import":"xsl:include",[o,a]=process.versions.node.split(".").map(Number);if(o<=17&&a<5)throw new Error(`Your Node.js version does not support \`<${s}>\`. If possible, please update your Node.js version to at least version 17.5.0.`);global.globalThis.fetch||(global.globalThis.fetch=fetch,global.globalThis.Headers=Headers,global.globalThis.Request=Request,global.globalThis.Response=Response);let l=t.childNodes.filter(m=>m.nodeName==="href");if(l.length<=0)throw new Error(`<${s}> with no href attribute defined.`);let u=l[0],d=yield(yield global.globalThis.fetch(u.nodeValue)).text(),h=this.xmlParser.xmlParse(d);yield this.xsltChildNodes(e,h.childNodes[0],r)})}xsltImport(e,t,r){return X(this,null,function*(){yield this.xsltImportOrInclude(e,t,r,!0)})}xsltInclude(e,t,r){return X(this,null,function*(){yield this.xsltImportOrInclude(e,t,r,!1)})}xsltKey(e,t){let r=f(t,"name"),n=f(t,"match"),s=f(t,"use");if(!r||!n||!s){let l="<xsl:key> missing required parameters: ";throw r||(l+="name, "),n||(l+="match, "),s||(l+="use, "),l=l.slice(0,-2),new Error(l)}let o;e.nodeList[e.position].nodeName==="#document"?o=e.clone(e.nodeList[e.position].childNodes):o=e;let a=this.xsltMatch(n,o);r in e.keys||(e.keys[r]={});for(let l of a){let u=e.clone([l]),d=this.xPath.xPathEval(s,u).stringValue();e.keys[r][d]=new _([l])}}xsltMessage(e,t){return X(this,null,function*(){let r=ie(this.outputDocument);yield this.xsltChildNodes(e,t,r);let n=B(r),s=f(t,"terminate")||"no";if(console.log(`[xsl:message] ${n}`),s==="yes")throw new Error(`xsl:message terminated: ${n}`)})}xsltNamespaceAlias(e){let t=f(e,"stylesheet-prefix"),r=f(e,"result-prefix");if(!t||!r)throw new Error("<xsl:namespace-alias> requires both stylesheet-prefix and result-prefix attributes.");this.namespaceAliases.set(t,r)}xsltNumber(e,t,r){let n=f(t,"value"),s=f(t,"level")||"single",o=f(t,"count"),a=f(t,"from"),l=f(t,"format")||"1",u=f(t,"lang"),c=f(t,"letter-value"),d=f(t,"grouping-separator"),h=f(t,"grouping-size"),m;if(n){let b=this.xPath.xPathEval(n,e);m=Math.round(b.numberValue())}else m=this.xsltNumberCount(e,s,o,a);let p=this.xsltFormatNumber(m,l,d,h),N=V(this.outputDocument,p),v=r||this.outputDocument;N.siblingPosition=v.childNodes.length,P(v,N)}xsltNumberCount(e,t,r,n){let s=e.nodeList[e.position],o=r||s.nodeName;switch(t){case"single":{let a=1,l=s.previousSibling;for(;l;)l.nodeType===s.nodeType&&this.nodeMatchesPattern(l,o)&&a++,l=l.previousSibling;return a}case"multiple":{let a=1,l=s.previousSibling;for(;l;)l.nodeType===s.nodeType&&this.nodeMatchesPattern(l,o)&&a++,l=l.previousSibling;return a}case"any":{let a=1,l=this.getAllPrecedingNodes(s);for(let u of l)this.nodeMatchesPattern(u,o)&&a++;return a}default:return 1}}nodeMatchesPattern(e,t){return t==="*"?e.nodeType===1:e.nodeName===t||e.localName===t}getAllPrecedingNodes(e){let t=[],r=e.previousSibling;for(;r;)t.push(r),this.collectDescendants(r,t),r=r.previousSibling;let n=e.parentNode;for(;n;){let s=n.previousSibling;for(;s;)t.push(s),this.collectDescendants(s,t),s=s.previousSibling;n=n.parentNode}return t}collectDescendants(e,t){for(let r of e.childNodes)r.nodeType===1&&(t.push(r),this.collectDescendants(r,t))}xsltFormatNumber(e,t,r,n){let s=t.charAt(0),o;switch(s){case"1":if(o=e.toString(),t.length>1&&t.match(/^0+1$/)){let a=t.length;o=e.toString().padStart(a,"0")}break;case"a":o=this.numberToAlpha(e,!1);break;case"A":o=this.numberToAlpha(e,!0);break;case"i":o=this.numberToRoman(e).toLowerCase();break;case"I":o=this.numberToRoman(e);break;default:o=e.toString()}if(r&&n){let a=parseInt(n,10);a>0&&!isNaN(a)&&(o=this.applyGrouping(o,r,a))}return o}numberToAlpha(e,t){if(e<=0)return"";let r="";for(;e>0;)e--,r=String.fromCharCode(e%26+(t?65:97))+r,e=Math.floor(e/26);return r}numberToRoman(e){if(e<=0||e>3999)return e.toString();let t=[[1e3,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]],r="";for(let[n,s]of t)for(;e>=n;)r+=s,e-=n;return r}applyGrouping(e,t,r){let n=e.split("."),s=n[0],o=n[1],a="",l=0;for(let u=s.length-1;u>=0;u--)l>0&&l%r===0&&(a=t+a),a=s[u]+a,l++;return o?a+"."+o:a}xsltSort(e,t){let r=[];for(let n of t.childNodes)if(n.nodeType==1&&this.isXsltElement(n,"sort")){let s=f(n,"select"),o=this.xPath.xPathParse(s),a=f(n,"data-type")||"text",l=f(n,"order")||"ascending";r.push({expr:o,type:a,order:l})}this.xPath.xPathSort(e,r)}xsltStripSpace(e){let t=f(e,"elements");if(t){let r=t.trim().split(/\s+/);this.stripSpacePatterns.push(...r)}}xsltPreserveSpace(e){let t=f(e,"elements");if(t){let r=t.trim().split(/\s+/);this.preserveSpacePatterns.push(...r)}}shouldStripWhitespaceNode(e){if(!e.nodeValue||!e.nodeValue.match(/^\s*$/)||this.stripSpacePatterns.length===0)return!1;let t=e.parentNode;if(!t||t.nodeType!==1)return!1;let r=t;for(;r&&r.nodeType===1;){let s=Q(r,"xml:space");if(s==="preserve")return!1;if(s==="default")break;r=r.parentNode}let n=t.localName||t.nodeName;for(let s of this.preserveSpacePatterns)if(this.matchesNamePattern(n,s,t))return!1;for(let s of this.stripSpacePatterns)if(this.matchesNamePattern(n,s,t))return!0;return!1}matchesNamePattern(e,t,r){if(t==="*")return!0;if(t.includes(":")){let[n,s]=t.split(":"),o=r.prefix||"";return s==="*"?o===n:o===n&&e===s}return e===t}xsltTemplate(e,t,r){return X(this,null,function*(){if(!e.inApplyTemplates&&e.baseTemplateMatched)return;let n=f(t,"match");if(!n)return;let s=this.xsltMatch(n,e,"self-and-siblings");if(s.length>0){this.firstTemplateRan=!0,e.inApplyTemplates||(e.baseTemplateMatched=!0);let o=e.clone(s,0);yield this.xsltChildNodes(o,t,r)}})}xsltText(e,t,r){let n=B(t),s=V(this.outputDocument,n);s.fromXslText=!0;let o=t.childNodes.filter(l=>l.nodeType===2&&l.nodeName==="disable-output-escaping");o.length>0&&o[0].nodeValue==="yes"&&(s.escape=!1);let a=r||this.outputDocument;s.siblingPosition=a.childNodes.length,a.appendChild(s)}validateStylesheetAttributes(e,t){let r=e.childNodes.filter(a=>a.nodeType===2),n=["version","id","extension-element-prefixes","exclude-result-prefixes","default-collation"],s=["xmlns"],o=!1;for(let a of r){let l=a.nodeName,u=a.nodeValue;if(a.prefix==="xmlns"){t.knownNamespaces[a.localName]=u;continue}if(l==="xmlns"){t.knownNamespaces[""]=u;continue}if(l==="version"){if(o=!0,!["1.0","2.0","3.0"].includes(u))throw new Error(`XSLT version not defined or invalid. Actual resolved version: ${u||"(none)"}.`);this.version=u,t.xsltVersion=u;continue}if(l==="extension-element-prefixes"){let c=u.split(/\s+/);for(let d of c)if(d&&!/^[a-zA-Z_:][\w:.-]*$/.test(d))throw new Error(`Invalid prefix in extension-element-prefixes: "${d}". Prefixes must be valid QNames.`);continue}if(l==="exclude-result-prefixes"){if(u!=="#all"){let c=u.split(/\s+/);for(let d of c)if(d&&!/^[a-zA-Z_:][\w:.-]*$/.test(d))throw new Error(`Invalid prefix in exclude-result-prefixes: "${d}". Prefixes must be valid QNames or "#all".`)}continue}if(l==="default-collation"){if(!u||u.trim().length===0)throw new Error("The default-collation attribute must contain a URI.");continue}if(l==="id"){if(!/^[a-zA-Z_:][\w:.-]*$/.test(u))throw new Error(`Invalid id attribute value: "${u}". IDs must be valid NCNames.`);continue}}}xsltTransformOrStylesheet(e,t,r){return X(this,null,function*(){this.validateStylesheetAttributes(t,e);let n=!1;for(let l of t.childNodes)if(l.nodeType===1)if(this.isXsltElement(l,"import")){if(n)throw new Error("<xsl:import> should be the first child node of <xsl:stylesheet> or <xsl:transform>.")}else n=!0;let s=[],o=[];for(let l of t.childNodes)l.nodeType===1&&this.isXsltElement(l,"template")?o.push(l):s.push(l);let a=e.clone();for(let l of s)yield this.xsltProcessContext(a,l,r);if(o.length>0){let l=lt(t,null,this.xPath),u=[];for(let c of l)try{let d=this.xsltMatch(c.matchPattern,a);d.length>0&&u.push({priority:c,matchedNodes:d})}catch(d){console.warn(`Failed to match pattern "${c.matchPattern}":`,d)}if(u.length>0){let c=u.find(p=>p.priority.matchPattern==="/"),d;c?d=c:(u.sort((p,N)=>p.priority.importPrecedence!==N.priority.importPrecedence?N.priority.importPrecedence-p.priority.importPrecedence:p.priority.effectivePriority!==N.priority.effectivePriority?N.priority.effectivePriority-p.priority.effectivePriority:N.priority.documentOrder-p.priority.documentOrder),d=u[0]);let h=u.filter(p=>p.priority.importPrecedence===d.priority.importPrecedence&&p.priority.effectivePriority===d.priority.effectivePriority);if(h.length>1){let p=h.map(N=>`"${N.priority.matchPattern}" (priority: ${N.priority.effectivePriority})`).join(", ");console.warn(`XSLT Warning: Ambiguous template match. Multiple templates match with equal priority: ${p}. Using the last one in document order.`)}this.firstTemplateRan=!0,a.baseTemplateMatched=!0;let m=a.clone(d.matchedNodes,0);yield this.xsltChildNodes(m,d.priority.template,r)}else{let c=e.nodeList[e.position];if(c&&c.childNodes&&c.childNodes.length>0){let d=c.childNodes.filter(h=>h.nodeName!=="#dtd-section");if(d.length>0){let h=e.clone(d);for(let m=0;m<h.contextSize();++m){let p=h.nodeList[m];if(p.nodeType===3){let N=e.clone([p],0);this.commonLogicTextNode(N,p,r)}else{let N=h.clone([p],0),v=We(l,N,this.matchResolver,this.xPath);if(v.selectedTemplate){let b=N.clone([p],0);b.inApplyTemplates=!0,yield this.xsltChildNodes(b,v.selectedTemplate,r)}else if(p.childNodes&&p.childNodes.length>0){let b=p.childNodes.filter(F=>F.nodeName!=="#dtd-section");if(b.length>0){let F=e.clone(b);for(let k=0;k<F.contextSize();++k){let R=F.nodeList[k];if(R.nodeType===3){let U=e.clone([R],0);this.commonLogicTextNode(U,R,r)}else{let U=F.clone([R],0),ut=We(l,U,this.matchResolver,this.xPath);if(ut.selectedTemplate){let ct=U.clone([R],0);ct.inApplyTemplates=!0,yield this.xsltChildNodes(ct,ut.selectedTemplate,r)}}}}}}}}}}}})}xsltValueOf(e,t,r){let n=f(t,"select"),s=e.nodeList[e.position],o=this.xPath.xPathEval(n,e);if(s&&s.nodeName==="#document"&&(o.stringValue()===""||o instanceof _&&o.nodeSetValue().length===0)){let c=s.childNodes.find(d=>d.nodeName!=="#dtd-section");if(c){let d=e.clone([c],0);o=this.xPath.xPathEval(n,d)}}let a=o.stringValue(),l=V(this.outputDocument,a),u=r||this.outputDocument;l.siblingPosition=u.childNodes.length,u.appendChild(l)}xsltVariable(e,t,r){return X(this,null,function*(){let n=f(t,"name"),s=f(t,"select"),o;if(t.childNodes.filter(l=>l.nodeType!==2).length>0){let l=ie(t.ownerDocument);yield this.xsltChildNodes(e,t,l),o=new _([l])}else if(s)o=this.xPath.xPathEval(s,e);else{let l="",u=this.options.parameters.filter(c=>c.name===n);u.length>0&&(l=u[0].value),o=new L(l)}(r||!e.getVariable(n))&&e.setVariable(n,o)})}xsltChildNodes(e,t,r){return X(this,null,function*(){let n=e.clone();for(let s=0;s<t.childNodes.length;++s){let o=t.childNodes[s];o.nodeType!==2&&(yield this.xsltProcessContext(n,o,r))}})}commonLogicTextNode(e,t,r){if(r){if(this.shouldStripWhitespaceNode(t))return;let n=V(this.outputDocument,t.nodeValue);n.siblingPosition=r.childNodes.length,P(r,n)}}xsltPassThrough(e,t,r){return X(this,null,function*(){switch(t.nodeType){case 3:this.xsltPassText(t)&&this.commonLogicTextNode(e,t,r);break;case 1:let n,s=e;n=e.nodeList[e.position];let o;o=z(this.outputDocument,t.nodeName),o.siblingPosition=n.siblingPosition,P(r||this.outputDocument,o),yield this.xsltChildNodes(s,t,o);let a=t.childNodes.filter(l=>(l==null?void 0:l.nodeType)===2);for(let l of a){let u=l.nodeName,c=this.xsltAttributeValue(l.nodeValue,s);$(o,u,c)}break;default:yield this.xsltChildNodes(e,t,r)}})}xsltPassText(e){if(!e.nodeValue.match(/^\s*$/))return!0;let t=e.parentNode;if(this.isXsltElement(t,"text"))return!0;for(;t&&t.nodeType==1;){let r=Q(t,"xml:space");if(r){if(r=="default")return!1;if(r=="preserve")return!0}t=t.parentNode}return!1}findAttributeInContext(e,t){return t.nodeList[t.position].childNodes.find(r=>r.nodeType===2&&r.nodeName===e)}xsltAttributeValue(e,t){let r=e.split("{");if(r.length===1)return e;let n="";for(let s=0;s<r.length;++s){let o=r[s].split("}");if(o.length!=2){n+=r[s];continue}let a=this.xPath.xPathEval(o[0],t).stringValue();n+=a+o[1]}return n}xsltMatch(e,t,r){let n=this.xPath.xPathParse(e,r);return this.matchResolver.expressionMatch(n,t)}xsltWithParam(e,t){return X(this,null,function*(){for(let r of t.childNodes)r.nodeType===1&&this.isXsltElement(r,"with-param")&&(yield this.xsltVariable(e,r,!0))})}isXsltElement(e,t){return t&&e.localName!=t?!1:e.namespaceUri?e.namespaceUri==="http://www.w3.org/1999/XSL/Transform":e.prefix==="xsl"}};ae();return Ye(Nr);})();
//# sourceMappingURL=xslt-processor.global.js.map